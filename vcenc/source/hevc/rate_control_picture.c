
#ifdef RATE_CONTROL_BUILD_SUPPORT
#include "vsi_string.h"
#include "rate_control_picture.h"
#include "tools.h"
#include "sw_slice.h"
#include <math.h>
#include "enccfg.h"
#include "sw_cu_tree.h"
#include "enc_log.h"
#define z515e436c6b(fmt, ...)                                                                      \
    VCEncTraceMsg(NULL, VCENC_LOG_INFO, VCENC_LOG_TRACE_RC, fmt, ##__VA_ARGS__)
#define z480357d3ba(fmt, ...)                                                                      \
    VCEncTraceMsg(NULL, VCENC_LOG_ERROR, VCENC_LOG_TRACE_RC, "\x5b\x25\x73\x3a\x25\x64\x5d" fmt,   \
                  __FUNCTION__, __LINE__, ##__VA_ARGS__)
#define z63fdc3a8e2(fmt, ...)                                                                      \
    VCEncTraceMsg(NULL, VCENC_LOG_DEBUG, VCENC_LOG_TRACE_RC, fmt, ##__VA_ARGS__)
#define z3c34408299 (0xca1 + 3684 - 0x1ab5)
#define zc0123ece74 (0x19a7 + 540 - 0x1b91)
#define DIV(a, b)                                                                                  \
    (((b) != (0x1ba1 + 477 - 0x1d7e)) ? ((a) + (SIGN(a) * (b)) / (0xc13 + 133 - 0xc96)) / (b) : (a))
#define z4c70129f71(a, b) (((a) + (SIGN(a) * (b)) / (0xddf + 127 - 0xe5c)) / (b))
#define zc39695dc8f (0xd61 + 3387 - 0x1a7c)
#define z7fdf199e36 (0x2317 + 300 - 0x23c3)
#define zebe6047df4 (-(0x1ba0 + 2185 - 0x2428) << (0xdab + 1625 - 0x13e5))
#define z66d3e33abc 9223372036854775807
#define z9ecd70b0bb (0x749 + 7887 - 0x2418)
#define z3b9adc5e7e (0x109a + 525 - 0xca7)
#define zbfa2339844 (0x704 + 3150 - 0x1338)
#define z84caec2dd6 ((0x159f + 4420 - 0x26e3))
#define z8bb1ff5d74 65535
#if (0x55f + 1681 - 0xbf0)
static const i32 zf47a134a71[(0x2a6 + 797 - 0x58e)] = {
    (0x2360 + 248 - 0x2455),  (0x22ac + 203 - 0x2374),  (0x1e43 + 1929 - 0x25c9),
    (0xbd6 + 4265 - 0x1c7b),  (0x1796 + 1001 - 0x1b7b), (0x1de1 + 53 - 0x1e11),
    (0x10ca + 3737 - 0x1f5e), (0x2ea + 3469 - 0x1071),  (0x791 + 5011 - 0x1b1d),
    (0x498 + 5684 - 0x1ac5),  (0x1b03 + 1071 - 0x1f2a), (0x7b3 + 6208 - 0x1fea),
    (0x18a6 + 1879 - 0x1ff3), (0x156d + 868 - 0x18c6),  (0xf50 + 4648 - 0x216b),
    (0x13b5 + 2644 - 0x1dfb), (0x9dd + 790 - 0xce3),    (0x72a + 502 - 0x90e),
    (0xf74 + 1617 - 0x15b1),  (0x4f0 + 7576 - 0x2271),  (0x12c7 + 2297 - 0x1ba7),
    (0x168d + 3073 - 0x2272), (0x997 + 5394 - 0x1e89),  (0x132f + 921 - 0x16a4),
    (0x1605 + 2488 - 0x1f95), (0xc91 + 2110 - 0x14a2),  (0x1825 + 1146 - 0x1c6c),
    (0x5d8 + 8002 - 0x24e1),  (0x1711 + 2041 - 0x1eca), (0x1953 + 1526 - 0x1f01),
    (0x14e6 + 2264 - 0x1d6e), (0x926 + 3744 - 0x176c),  (0x1093 + 5150 - 0x244c),
    (0x378 + 3605 - 0x111b),  (0x1bb5 + 2353 - 0x2466), (0x16e5 + 1987 - 0x1e18),
    (0x100b + 2275 - 0x184e), (0xfb + 5636 - 0x164b),   (0x968 + 3037 - 0x147a),
    (0xe58 + 3246 - 0x1a22),  (0x533 + 8125 - 0x23f0),  (0x1251 + 4595 - 0x2324),
    (0x2155 + 485 - 0x21fa),  (0x2a3 + 6188 - 0x1967),  (0x18e2 + 3220 - 0x23e1),
    (0x383 + 1521 - 0x7ac),   (0x62d + 4445 - 0x1589),  (0x1241 + 3921 - 0x1f51),
    (0x18ed + 2513 - 0x203e), (0x1072 + 761 - 0x109b),  (0x1813 + 11 - 0x14f4),
    (0x403 + 1783 - 0x77a)};
#else
#if (0xb57 + 6637 - 0x2544)
static const i32 zf47a134a71[(0x482 + 3493 - 0x11f2)] = {
    (0x794 + 4301 - 0x185f),  (0x6e6 + 1686 - 0xd79),   (0x1e30 + 728 - 0x2105),
    (0xbb6 + 6613 - 0x2587),  (0x1685 + 1553 - 0x1c92), (0xb18 + 5181 - 0x1f51),
    (0xb97 + 2434 - 0x1514),  (0x10b6 + 3291 - 0x1d8b), (0x2ca + 2209 - 0xb65),
    (0xafd + 3392 - 0x1836),  (0xa6d + 2694 - 0x14eb),  (0x4ad + 3724 - 0x1330),
    (0x708 + 4312 - 0x17d6),  (0x51a + 8357 - 0x25b4),  (0x25fd + 174 - 0x269e),
    (0x48 + 7810 - 0x1ebc),   (0x528 + 4226 - 0x159a),  (0x11bb + 4661 - 0x23de),
    (0x143c + 220 - 0x1504),  (0x117 + 5353 - 0x15ea),  (0x677 + 5626 - 0x1c58),
    (0x1947 + 3246 - 0x25d9), (0x24b + 7766 - 0x2082),  (0x60d + 2492 - 0xfa6),
    (0x1509 + 3632 - 0x2312), (0x2b8 + 1483 - 0x857),   (0xfbd + 3367 - 0x1cb2),
    (0x67d + 387 - 0x7c8),    (0xe9 + 9170 - 0x247c),   (0x3e3 + 7903 - 0x227b),
    (0x16fa + 2135 - 0x1f02), (0xa46 + 4053 - 0x19c3),  (0x2460 + 277 - 0x2511),
    (0x23d8 + 582 - 0x25ae),  (0x1d3 + 2699 - 0xbe0),   (0x396 + 442 - 0x4c3),
    (0x105b + 1525 - 0x15b3), (0x208 + 7235 - 0x1d9a),  (0x8a1 + 2749 - 0x1296),
    (0x215d + 215 - 0x2154),  (0x1beb + 156 - 0x1b8b),  (0x182a + 3284 - 0x23e3),
    (0x46f + 5917 - 0x1a52),  (0x8ea + 2438 - 0x110e),  (0x1030 + 2975 - 0x1a3e),
    (0x1c32 + 1971 - 0x2225), (0xed0 + 6457 - 0x2612),  (0x1500 + 2256 - 0x1b9a),
    (0x1c6c + 1949 - 0x2194), (0x2cd + 715 - 0x2d5),    (0x7b9 + 1377 - 0x9f8),
    (0x8c8 + 2218 - 0xdf2)};
#else
#if (0xf35 + 4261 - 0x1fda)
static const float zf47a134a71[(0x159a + 2988 - 0x1f47)] = {
    2.475138122, 2.503897841, 2.532991733, 2.562423679, 2.592197608, 2.622317493, 2.652787355,
    2.683611259, 2.71479332,  2.746337699, 2.778248606, 2.8105303,   2.843187089, 2.876223331,
    2.909643437, 2.943451865, 2.977653128, 3.012251791, 3.047252471, 3.082659839, 3.118478621,
    3.154713597, 3.191369603, 3.228451532, 3.265964332, 3.303913009, 3.342302629, 3.381138315,
    3.42042525,  3.460168677, 3.5003739,   3.541046286, 3.582191262, 3.623814319, 3.665921013,
    3.708516964, 3.751607855, 3.795199439, 3.839297532, 3.883908021, 3.929036858, 3.974690067,
    4.020873741, 4.067594043, 4.11485721,  4.162669547, 4.211037438, 4.259967336, 4.309465772,
    4.359539352, 4.410194759, 4.461438754, 4.513278175, 4.565719942, 4.618771052, 4.672438587,
    4.726729708, 4.781651661, 4.837211777, 4.893417471, 4.950276243, 5.007795682, 5.065983465,
    5.124847358, 5.184395216, 5.244634986, 5.30557471,  5.367222518, 5.42958664,  5.492675398,
    5.556497212, 5.621060599, 5.686374177, 5.752446663, 5.819286873, 5.88690373,  5.955306256,
    6.024503581, 6.094504941, 6.165319678, 6.236957241, 6.309427194, 6.382739206, 6.456903064,
    6.531928663, 6.607826018, 6.684605258, 6.76227663,  6.8408505,   6.920337354, 7.0007478,
    7.082092572, 7.164382523, 7.247628638, 7.331842027, 7.417033928, 7.50321571,  7.590398877,
    7.678595064, 7.767816041, 7.858073716, 7.949380134, 8.041747482, 8.135188087, 8.229714419,
    8.325339095, 8.422074875, 8.519934672, 8.618931544, 8.719078704, 8.820389519, 8.922877508,
    9.026556351, 9.131439883, 9.237542104, 9.344877173, 9.453459416, 9.563303323, 9.674423555,
    9.786834942, 9.900552486, 10.01559136, 10.13196693, 10.24969472, 10.36879043, 10.48926997,
    10.61114942, 10.73444504, 10.85917328, 10.9853508,  11.11299442, 11.2421212,  11.37274835,
    11.50489333, 11.63857375, 11.77380746, 11.91061251, 12.04900716, 12.18900988, 12.33063936,
    12.47391448, 12.61885439, 12.76547841, 12.91380613, 13.06385733, 13.21565204, 13.36921052,
    13.52455326, 13.681701,   13.84067471, 14.0014956,  14.16418514, 14.32876505, 14.49525728,
    14.66368405, 14.83406786, 15.00643142, 15.18079775, 15.35719013, 15.53563208, 15.71614743,
    15.89876027, 16.08349496, 16.27037617, 16.45942884, 16.65067819, 16.84414975, 17.03986934,
    17.23786309, 17.43815741, 17.64077904, 17.84575502, 18.0531127,  18.26287977, 18.47508421,
    18.68975435, 18.90691883, 19.12660665, 19.34884711, 19.57366988, 19.80110497, 20.03118273,
    20.26393386, 20.49938943, 20.73758086, 20.97853995, 21.22229884, 21.46889007, 21.71834656,
    21.97070159, 22.22598885, 22.4842424,  22.74549671, 23.00978665, 23.27714749, 23.54761492,
    23.82122502, 24.09801433, 24.37801976, 24.66127871, 24.94782897, 25.23770878, 25.53095683,
    25.82761225, 26.12771465, 26.43130407, 26.73842103, 27.04910652, 27.363402,   27.68134941,
    28.0029912,  28.32837029, 28.65753009, 28.99051455, 29.32736811, 29.66813571, 30.01286284,
    30.36159551, 30.71438026, 31.07126416, 31.43229486, 31.79752054, 32.16698993, 32.54075235,
    32.91885768, 33.30135638, 33.6882995,  34.07973869, 34.47572618, 34.87631482, 35.28155808,
    35.69151003, 36.1062254,  36.52575953, 36.95016842, 37.37950869, 37.81383766, 38.25321329,
    38.69769422, 39.14733977, 39.60220994, 40.06236546, 40.52786772, 40.99877886, 41.47516173,
    41.95707989, 42.44459768, 42.93778015, 43.43669312, 43.94140318, 44.45197769, 44.96848479,
    45.49099342, 46.0195733,  46.55429498, 47.09522984, 47.64245005, 48.19602865, 48.75603953,
    49.32255742, 49.89565793, 50.47541755, 51.06191365, 51.65522451, 52.25542931, 52.86260815,
    53.47684207, 54.09821304, 54.726804,   55.36269883, 56.0059824,  56.65674057, 57.31506019,
    57.98102911, 58.65473621, 59.33627142, 60.02572568, 60.72319102, 61.42876051, 62.14252833,
    62.86458973, 63.59504107, 64.33397986, 65.0815047,  65.83771535, 66.60271276, 67.376599,
    68.15947737, 68.95145235, 69.75262963, 70.56311615, 71.38302007, 72.21245081, 73.05151907,
    73.90033683, 74.75901738, 75.62767532, 76.50642658, 77.39538844, 78.29467953, 79.20441989,
    80.12473092, 81.05573545, 81.99755772, 82.95032345, 83.91415978, 84.88919535, 85.87556029,
    86.87338624, 87.88280636, 88.90395538, 89.93696959, 90.98198684, 92.0391466,  93.10858997,
    94.19045967, 95.2849001,  96.3920573,  97.51207906, 98.64511484, 99.79131586, 100.9508351,
    102.1238273, 103.310449,  104.5108586, 105.7252163, 106.9536841, 108.1964261, 109.453608,
    110.7253977, 112.0119648, 113.3134811, 114.6301204, 115.9620582, 117.3094724, 118.6725428,
    120.0514514, 121.446382,  122.857521,  124.2850567, 125.7291795, 127.1900821, 128.6679597,
    130.1630094, 131.6754307, 133.2054255, 134.753198,  136.3189547, 137.9029047, 139.5052593,
    141.1262323, 142.7660401, 144.4249016, 146.1030381, 147.8006737, 149.5180348, 151.2553506,
    153.0128532, 154.7907769, 156.5893591, 158.4088398, 160.2494618, 162.1114709, 163.9951154,
    165.9006469, 167.8283196, 169.7783907, 171.7511206, 173.7467725, 175.7656127, 177.8079108,
    179.8739392, 181.9639737, 184.0782932, 186.2171799, 188.3809193, 190.5698002, 192.7841146,
    195.0241581, 197.2902297, 199.5826317, 201.9016702, 204.2476546, 206.620898,  209.0217172,
    211.4504326, 213.9073683, 216.3928522, 218.907216,  221.4507953, 224.0239296, 226.6269623,
    229.2602408, 231.9241164, 234.6189449, 237.3450857, 240.1029027, 242.8927641, 245.7150421,
    248.5701133, 251.4583589, 254.3801643, 257.3359194, 260.3260188, 263.3508614, 266.410851,
    269.506396,  272.6379095, 275.8058094, 279.0105185, 282.2524646, 285.5320803, 288.8498032,
    292.2060763, 295.6013473, 299.0360695, 302.5107013, 306.0257063, 309.5815538, 313.1787181,
    316.8176796, 320.4989237, 324.2229418, 327.9902309, 331.8012938, 335.6566391, 339.5567814,
    343.5022412, 347.4935449, 351.5312254, 355.6158215, 359.7478783, 363.9279473, 368.1565864,
    372.4343599, 376.7618387, 381.1396004, 385.5682292, 390.0483162, 394.5804594, 399.1652635,
    403.8033404, 408.4953092, 413.2417961, 418.0434344, 422.9008652, 427.8147365, 432.7857043,
    437.814432,  442.9015906, 448.0478592, 453.2539246, 458.5204815, 463.8482329, 469.2378897,
    474.6901714, 480.2058055, 485.7855282, 491.4300841, 497.1402266, 502.9167178, 508.7603286,
    514.6718389, 520.6520376, 526.7017228, 532.8217021, 539.012792,  545.275819,  551.6116188,
    558.0210371, 564.5049292, 571.0641605, 577.6996065, 584.4121525, 591.2026947, 598.0721391,
    605.0214026, 612.0514127, 619.1631075, 626.3574363, 633.6353591, 640.9978473, 648.4458836,
    655.9804618, 663.6025876, 671.3132783, 679.1135628, 687.0044823, 694.9870899, 703.0624509,
    711.2316431, 719.4957567, 727.8558947, 736.3131728, 744.8687198, 753.5236774, 762.2792008,
    771.1364584, 780.0966325, 789.1609187, 798.3305269, 807.6066808, 816.9906184, 826.4835921,
    836.0868689, 845.8017304, 855.6294731, 865.5714087, 875.628864,  885.8031813, 896.0957185};
#else
static const i32 zf47a134a71[(0x1903 + 696 - 0x19bc)] = {(0x1d7c + 2576 - 0x2513),
                                                         (0x1321 + 1092 - 0x14e5),
                                                         (0x496 + 492 - 0x3fa),
                                                         (0x161b + 4703 - 0x25eb),
                                                         (0x2438 + 1026 - 0x25a3),
                                                         (0x6a4 + 100 - 0x469),
                                                         (0xa1c + 2137 - 0xfce),
                                                         (0xe1d + 5945 - 0x22a7),
                                                         (0x2079 + 2218 - 0x266d),
                                                         (0x90c + 6013 - 0x1dca),
                                                         (0x12d8 + 2231 - 0x18c8),
                                                         (0x19cb + 4093 - 0x26f9),
                                                         (0xb43 + 5317 - 0x1d31),
                                                         (0xa0d + 302 - 0x85b),
                                                         (0x8aa + 5612 - 0x1bae),
                                                         (0x178a + 3854 - 0x23a7),
                                                         (0x1348 + 3989 - 0x1fe3),
                                                         (0x1222 + 5895 - 0x2626),
                                                         (0xe92 + 5753 - 0x21ff),
                                                         (0xcdf + 4707 - 0x1c2d),
                                                         (0x1d8c + 2789 - 0x2553),
                                                         (0xdc6 + 2378 - 0x13e9),
                                                         (0x4dd + 6606 - 0x1b7b),
                                                         (0x7ac + 7908 - 0x2356),
                                                         (0x13c9 + 3746 - 0x1f27),
                                                         (0x601 + 1082 - 0x6ee),
                                                         (0x13a0 + 2421 - 0x19be),
                                                         (0x161c + 1923 - 0x1a3e),
                                                         (0x18ff + 1933 - 0x1d21),
                                                         (0x395 + 9513 - 0x2549),
                                                         (0x5b2 + 3758 - 0x10e0),
                                                         (0x147b + 992 - 0x14d1),
                                                         (0xba5 + 7768 - 0x2668),
                                                         (0x73d + 7819 - 0x2229),
                                                         (0x22ea + 815 - 0x226f),
                                                         (0x1833 + 3672 - 0x22d6),
                                                         (0x128f + 1982 - 0x168d),
                                                         (0x782 + 5195 - 0x1802),
                                                         (0x14ad + 3952 - 0x2047),
                                                         (0x1233 + 6084 - 0x2615),
                                                         (0x144c + 931 - 0x1402),
                                                         (0x8a5 + 6846 - 0x1f6a),
                                                         (0xacb + 7247 - 0x2315),
                                                         (0x6f7 + 6713 - 0x1d1f),
                                                         (0x829 + 1734 - 0xad2),
                                                         (0xaa9 + 6333 - 0x1f3d),
                                                         (0xcea + 1468 - 0xe70),
                                                         (0xad6 + 3796 - 0x1568),
                                                         (0x1aea + 1667 - 0x1d1e),
                                                         (0x4a5 + 9075 - 0x23bc),
                                                         (0x1e5c + 3345 - 0x2704),
                                                         (0x8a8 + 2247 - 0xcf9),
                                                         (0x11f2 + 5222 - 0x21d5),
                                                         (0x262d + 1167 - 0x262c),
                                                         (0x5f7 + 1195 - 0x604),
                                                         (0xe68 + 3666 - 0x180e),
                                                         (0x1012 + 6049 - 0x22f9),
                                                         1224,
                                                         (0x12dc + 3886 - 0x1d34),
                                                         (0x697 + 7316 - 0x1e47),
                                                         (0xb25 + 4193 - 0x1693),
                                                         (0x1eff + 484 - 0x1be2),
                                                         (0x83c + 8813 - 0x2599),
                                                         (0x5e5 + 7693 - 0x1ed3),
                                                         (0x197c + 3344 - 0x215d),
                                                         (0xc34 + 3421 - 0x1453),
                                                         (0x1e53 + 2223 - 0x21b4),
                                                         (0x5e5 + 8336 - 0x2117),
                                                         (0x69f + 6502 - 0x1a98),
                                                         (0x918 + 3091 - 0xfad),
                                                         (0x157c + 3113 - 0x1c17),
                                                         (0x1e1a + 2375 - 0x21c3),
                                                         1455,
                                                         (0xd27 + 1409 - 0xce8),
                                                         (0x9d7 + 1014 - 0x7fc),
                                                         (0x1f34 + 737 - 0x1c32),
                                                         (0x851 + 8389 - 0x2322),
                                                         (0x25bc + 1366 - 0x250c),
                                                         (0x1448 + 1398 - 0x13a6),
                                                         (0x2029 + 183 - 0x1ab6),
                                                         (0x11aa + 3781 - 0x1a33),
                                                         (0x778 + 7630 - 0x1ef7),
                                                         (0x1883 + 454 - 0x13e8),
                                                         (0xd16 + 651 - 0x92d),
                                                         (0x76c + 8506 - 0x221e),
                                                         (0x1965 + 4899 - 0x25ed),
                                                         (0x1a63 + 2300 - 0x1cb0),
                                                         (0xddf + 4692 - 0x1970),
                                                         (0x1eb1 + 2158 - 0x2048),
                                                         (0x10fd + 4028 - 0x19ce),
                                                         (0x934 + 7590 - 0x1fda),
                                                         (0x147c + 4902 - 0x208d),
                                                         (0x9ba + 8872 - 0x2538),
                                                         (0x1173 + 3314 - 0x1726),
                                                         (0x131b + 13 - 0xbd4),
                                                         (0x111d + 6525 - 0x2330),
                                                         1920,
                                                         (0xb2b + 411 - 0x52f),
                                                         (0x1f76 + 950 - 0x1b7f),
                                                         (0x129f + 2399 - 0x143a),
                                                         (0xd39 + 2339 - 0xe81),
                                                         (0xd02 + 6841 - 0x1fc8),
                                                         (0x125b + 2988 - 0x15fd),
                                                         (0xdc3 + 670 - 0x83f),
                                                         (0x92d + 8729 - 0x230c),
                                                         2131,
                                                         (0x1d98 + 4135 - 0x2553),
                                                         (0x1403 + 2530 - 0x1560),
                                                         (0xf04 + 7192 - 0x227e),
                                                         (0x1864 + 4187 - 0x2007),
                                                         (0x19ef + 178 - 0x11cf),
                                                         (0xb1a + 8125 - 0x21eb),
                                                         (0xe59 + 7124 - 0x2127),
                                                         (0x21ec + 2013 - 0x20a8),
                                                         (0xd6b + 3782 - 0x12f5),
                                                         (0x1236 + 384 - 0xa5e),
                                                         (0x1b64 + 1096 - 0x1638),
                                                         (0xb88 + 4893 - 0x1515),
                                                         (0x1ef7 + 1347 - 0x1a8e),
                                                         (0x16a8 + 5770 - 0x2369),
                                                         (0xb5d + 1789 - 0x874),
                                                         (0xda6 + 4198 - 0x1409),
                                                         (0x18ec + 4440 - 0x2023),
                                                         (0x1491 + 1122 - 0xeb4),
                                                         2654,
                                                         (0x19c0 + 5527 - 0x24da),
                                                         (0x241d + 2965 - 0x2516),
                                                         (0x1c34 + 3223 - 0x1e0f),
                                                         (0xf43 + 829 - 0x7a5),
                                                         (0xfcc + 8060 - 0x244c),
                                                         (0x19ea + 4124 - 0x1eea),
                                                         (0xb47 + 3698 - 0xe7c),
                                                         (0x1122 + 1653 - 0xc38),
                                                         (0x1046 + 2332 - 0xde1),
                                                         (0xf04 + 8506 - 0x249b),
                                                         (0xd70 + 1754 - 0x884),
                                                         (0x1ce7 + 1038 - 0x150c),
                                                         (0x1830 + 3742 - 0x1ac2),
                                                         (0xf2f + 2583 - 0xd16),
                                                         (0x1c22 + 4115 - 0x1fe1),
                                                         (0x1f17 + 3275 - 0x1f69),
                                                         (0x1a2f + 2345 - 0x16ba),
                                                         (0x1afa + 377 - 0xfb0),
                                                         (0x2607 + 189 - 0x19db),
                                                         (0x13a1 + 349 - 0x7ee),
                                                         (0x172d + 5892 - 0x20fa),
                                                         (0x1b20 + 5306 - 0x227c),
                                                         (0xee0 + 3182 - 0xdc8),
                                                         (0x17f2 + 5165 - 0x1e71),
                                                         (0xf7f + 2554 - 0xba2),
                                                         (0x16fc + 4059 - 0x18d7),
                                                         (0x19d6 + 3796 - 0x1a80),
                                                         (0x100b + 2644 - 0xc0b),
                                                         (0x2453 + 3768 - 0x248d),
                                                         (0x1632 + 3281 - 0x145a),
                                                         (0x26b5 + 2473 - 0x2189),
                                                         (0x1398 + 5001 - 0x1820),
                                                         (0x1818 + 5206 - 0x1d40),
                                                         (0x2642 + 3952 - 0x2657),
                                                         (0x1ed9 + 2727 - 0x19f7),
                                                         (0x190c + 1313 - 0xe76),
                                                         (0x23a1 + 4210 - 0x242d),
                                                         (0x191a + 1885 - 0x1062),
                                                         (0x1894 + 2096 - 0x107f),
                                                         4213,
                                                         (0x112a + 1452 - 0x630),
                                                         (0x1ab3 + 1264 - 0xecb),
                                                         4362,
                                                         (0x16ca + 3090 - 0x11a0),
                                                         (0x18d9 + 681 - 0xa12),
                                                         (0x211d + 2265 - 0x1852),
                                                         (0x16ab + 594 - 0x725),
                                                         (0x1d1b + 4208 - 0x1b7e),
                                                         4675,
                                                         (0x2633 + 3454 - 0x2138),
                                                         4784,
                                                         (0x1b95 + 689 - 0xb5e),
                                                         4896,
                                                         4953,
                                                         (0x1cfa + 3970 - 0x18ea),
                                                         (0x2620 + 1431 - 0x17ea),
                                                         (0x1cb8 + 1089 - 0xcf2),
                                                         (0x1775 + 1116 - 0x78e),
                                                         (0x15cc + 1225 - 0x616),
                                                         (0x17b5 + 3450 - 0x1073),
                                                         (0x177d + 9286 - 0x26c9),
                                                         (0x26ff + 3166 - 0x1e25),
                                                         (0x25c1 + 3484 - 0x1de5),
                                                         5559,
                                                         (0x19cd + 7698 - 0x21e7),
                                                         (0x1a3d + 7700 - 0x2218),
                                                         (0x1ee4 + 6609 - 0x223a),
                                                         5822,
                                                         5890,
                                                         (0x247f + 1420 - 0x12c5),
                                                         (0x1fff + 3345 - 0x1584),
                                                         6098,
                                                         (0x1a0d + 459 - 0x3bf),
                                                         6240,
                                                         6313,
                                                         6386,
                                                         6460,
                                                         6535,
                                                         (0x1f74 + 8422 - 0x2687),
                                                         6688,
                                                         6766,
                                                         6845,
                                                         6924,
                                                         7005,
                                                         7086,
                                                         (0x1e09 + 88 - 0x261),
                                                         7252,
                                                         7336,
                                                         7421,
                                                         (0x262b + 2379 - 0x1223),
                                                         7595,
                                                         7683,
                                                         (0x20ba + 6855 - 0x1d25),
                                                         (0x2132 + 8320 - 0x22fc),
                                                         (0x2512 + 1106 - 0xa52),
                                                         (0x252a + 1544 - 0xbc4),
                                                         (0x2356 + 1386 - 0x8f4),
                                                         8234,
                                                         8330,
                                                         8427,
                                                         8525,
                                                         8624,
                                                         8724,
                                                         8825,
                                                         8928,
                                                         9032,
                                                         9137,
                                                         9243,
                                                         9350,
                                                         9459,
                                                         9569,
                                                         9680,
                                                         9792,
                                                         9906,
                                                         10021,
                                                         10138,
                                                         10255,
                                                         10375,
                                                         10495,
                                                         10617,
                                                         10741,
                                                         10865,
                                                         10992,
                                                         11119,
                                                         11248,
                                                         11379,
                                                         11511,
                                                         11645,
                                                         11781,
                                                         11917,
                                                         12056,
                                                         12196,
                                                         12338,
                                                         12481,
                                                         12626,
                                                         12773,
                                                         12921,
                                                         13071,
                                                         13223,
                                                         13377,
                                                         13532,
                                                         13690,
                                                         13849,
                                                         14010,
                                                         14172,
                                                         14337,
                                                         14504,
                                                         14672,
                                                         14843,
                                                         15015,
                                                         15190,
                                                         15366,
                                                         15545,
                                                         15725,
                                                         15908,
                                                         16093,
                                                         16280,
                                                         16469,
                                                         16660,
                                                         16854,
                                                         17050,
                                                         17248,
                                                         17448,
                                                         17651,
                                                         17856,
                                                         18064,
                                                         18274,
                                                         18486,
                                                         18701,
                                                         18918,
                                                         19138,
                                                         19360,
                                                         19585,
                                                         19813,
                                                         20043,
                                                         20276,
                                                         20511,
                                                         20750,
                                                         20991,
                                                         21235,
                                                         21482,
                                                         21731,
                                                         21984,
                                                         22239,
                                                         22497,
                                                         22759,
                                                         23023,
                                                         23291,
                                                         23562,
                                                         23835,
                                                         24112,
                                                         24392,
                                                         24676,
                                                         24963,
                                                         25253,
                                                         25546,
                                                         25843,
                                                         26143,
                                                         26447,
                                                         26754,
                                                         27065,
                                                         27380,
                                                         27698,
                                                         28020,
                                                         28345,
                                                         28675,
                                                         29008,
                                                         29345,
                                                         29686,
                                                         30031,
                                                         30380,
                                                         30733,
                                                         31090,
                                                         31451,
                                                         31816,
                                                         32186,
                                                         32560,
                                                         32938,
                                                         33321,
                                                         33708,
                                                         34100,
                                                         34496,
                                                         34897,
                                                         35303,
                                                         35713,
                                                         36128,
                                                         36548,
                                                         36972,
                                                         37402,
                                                         37836,
                                                         38276,
                                                         38721,
                                                         39171,
                                                         39626,
                                                         40086,
                                                         40552,
                                                         41023,
                                                         41500,
                                                         41982,
                                                         42470,
                                                         42964,
                                                         43463,
                                                         43968,
                                                         44479,
                                                         44995,
                                                         45518,
                                                         46047,
                                                         46582,
                                                         47124,
                                                         47671,
                                                         48225,
                                                         48785,
                                                         49352,
                                                         49926,
                                                         50506,
                                                         51093,
                                                         51686,
                                                         52287,
                                                         52894,
                                                         53509,
                                                         54131,
                                                         54760,
                                                         55396,
                                                         56040,
                                                         56691,
                                                         57350,
                                                         58016,
                                                         58690,
                                                         59372,
                                                         60062,
                                                         60760,
                                                         61466,
                                                         62180,
                                                         62903,
                                                         63633,
                                                         64373,
                                                         65121,
                                                         65877,
                                                         66643,
                                                         67417,
                                                         68201,
                                                         68993,
                                                         69795,
                                                         70606,
                                                         71426,
                                                         72256,
                                                         73096,
                                                         73945,
                                                         74804,
                                                         75673,
                                                         76553,
                                                         77442,
                                                         78342,
                                                         79252,
                                                         80173,
                                                         81105,
                                                         82047,
                                                         83001,
                                                         83965,
                                                         84941,
                                                         85928,
                                                         86926,
                                                         87936,
                                                         88958,
                                                         89991,
                                                         91037,
                                                         92095,
                                                         93165,
                                                         94248,
                                                         95343,
                                                         96451,
                                                         97571,
                                                         98705,
                                                         99852,
                                                         101012,
                                                         102186,
                                                         103373,
                                                         104574,
                                                         105789,
                                                         107019,
                                                         108262,
                                                         109520,
                                                         110793,
                                                         112080,
                                                         113382,
                                                         114700,
                                                         116033,
                                                         117381,
                                                         118745,
                                                         120124,
                                                         121520,
                                                         122932,
                                                         124361,
                                                         125806,
                                                         127267,
                                                         128746,
                                                         130242,
                                                         131755,
                                                         133286,
                                                         134835,
                                                         136402,
                                                         137987,
                                                         139590,
                                                         141212,
                                                         142853,
                                                         144513,
                                                         146192,
                                                         147891,
                                                         149609,
                                                         151347,
                                                         153106,
                                                         154885,
                                                         156685,
                                                         158505,
                                                         160347,
                                                         162210,
                                                         164095,
                                                         166002,
                                                         167931,
                                                         169882,
                                                         171856,
                                                         173853,
                                                         175873,
                                                         177916,
                                                         179983,
                                                         182075,
                                                         184190,
                                                         186331,
                                                         188496,
                                                         190686,
                                                         192902,
                                                         195143,
                                                         197410,
                                                         199704,
                                                         202025,
                                                         204372,
                                                         206747,
                                                         209149,
                                                         211579,
                                                         214038,
                                                         216525,
                                                         219041,
                                                         221586,
                                                         224160,
                                                         226765,
                                                         229400};
#endif
#endif
#endif
#ifdef z8432f9496f
static const double z65557a7fa6[] = {
    0.2125,  0.2385,  0.2677,  0.3005,  0.3373,  0.3786,  0.4250,  0.4770,  0.5355,
    0.6010,  0.6746,  0.7573,  0.8500,  0.9541,  1.0709,  1.2021,  1.3493,  1.5145,
    1.7000,  1.9082,  2.1419,  2.4042,  2.6986,  3.0291,  3.4000,  3.8164,  4.2837,
    4.8083,  5.3972,  6.0581,  6.8000,  7.6327,  8.5675,  9.6167,  10.7943, 12.1162,
    13.6000, 15.2655, 17.1349, 19.2333, 21.5887, 24.2324, 27.2000, 30.5310, 34.2699,
    38.4666, 43.1773, 48.4649, 54.4000, 61.0619, 68.5397, 76.9332};
#endif
#define z6e73376728 ((0x168f + 4200 - 0x26e7))
#define zc6f63b430a ((0x12d0 + 1594 - 0x1908))
static i32 ze173611d5a(i32 zdfcc1a3d2b, i32 z2ca8f76d00);
static void ze5478205f0(vcencRateControl_s *zca7520bb04, i32 nonZeroCnt);
static void z32ae321340(vcencRateControl_s *zca7520bb04);
static void z09ffe405ea(vcencRateControl_s *zca7520bb04);
static i32 z91c793fa15(vcencRateControl_s *zca7520bb04, i32 zeabf8072f6, true_e hrd);
static void z1b20e4cee0(vcencRateControl_s *zca7520bb04);
static i32 z2f5e53679d(vcencRateControl_s *zca7520bb04);
static i32 zd401dac647(vcencRateControl_s *zca7520bb04, true_e z7fab9beeb1);
static i32 z9a356800c4(za506561fab *p, i32 n);
static void zd8c80794d2(za506561fab *p, i32 z2fd9172e8b, i32 zdfcc1a3d2b);
static void z6770053a09(vcencRateControl_s *zca7520bb04);
static void zbd530d7c11(zcf4bacd786 *zafb762023b, i32 z3524d4da5f);
static i32 z17ef4a756a(zcf4bacd786 *zafb762023b);
static i32 za9481c4a4e(zcf4bacd786 *zafb762023b);
static void z8b44f88b8d(z5a5950b51a *zafb762023b, u32 intraCu8Num, u32 skipCu8Num,
                        u32 PBFrame4NRdCost);
static void z4fb3eda91c(z5a5950b51a *zafb762023b);
static i32 zf32036a4e1(vcencRateControl_s *zca7520bb04, i32 z4986b5c1c6);
static void ze10b04996e(vcencRateControl_s *zca7520bb04);
static double zc7f7a46e4e(zba7eff2a5d *p, double zaa4daa1798, double zf70a512cde);
static void z62ee9d4307(vcencRateControl_s *zca7520bb04, double zaa4daa1798, double zf70a512cde,
                        double zdfcc1a3d2b, i32 z2fd9172e8b);
static void z2089ed76c2(vcencRateControl_s *zca7520bb04, double zf70a512cde);
static double z8ed97f0b4b(double zea9fae6ac8);
static double zd125839e6a(i32 z2fd9172e8b);
static i32 zb93ff510f9(vcencRateControl_s *zca7520bb04);
void zc7b4f40dbc(vcencRateControl_s *zca7520bb04);
double zcc713675e6(double z2fd9172e8b);
i32 z3a498c503b(vcencRateControl_s *zca7520bb04);
#if VBR_RC
i32 z6f9934742b(vcencRateControl_s *zca7520bb04, i32 z2fd9172e8b, double z48c212deb3);
u32 z0328911646(vcencRateControl_s *zca7520bb04, i32 z2fd9172e8b, u32 zca7ef8d119, u32 zc028475fbc);
i32 z4bfe0f8f2a(vcencRateControl_s *zca7520bb04, i32 z2fd9172e8b, i32 z3cf4db5794);
void z1f46318dc7(vcencRateControl_s *zca7520bb04);
void z57f9202139(vcencRateControl_s *zca7520bb04, i32 z158c94c7a8);
void z1772c644d6(vcencRateControl_s *zca7520bb04);
#endif
i32 z1ef68cc885(vcencRateControl_s *zca7520bb04, double *z88c68737a0, i32 *zc8ac131109,
                double zc81a731bd6);
void z50e433b3c6(vcencRateControl_s *zca7520bb04)
{
    u32 zebf028c6a8 = zca7520bb04->ctbPerPic * (zca7520bb04->ctbSize / (0x6f8 + 5484 - 0x1c54)) *
                      (zca7520bb04->ctbSize / (0xab2 + 1049 - 0xebb));
    float z4c1099c119 = zebf028c6a8 * (0xa29 + 298 - 0xadb);
    double z475da5d694 =
        zca7520bb04->pass == (0xb81 + 2351 - 0x14ae) ? (1.0 - 0.6) * 13.5 : (0x7c0 + 272 - 0x8d0);
    zca7520bb04->z247948ead7 = pow(z4c1099c119, (0x472 + 4923 - 0x17ac) - (0xf43 + 3883 - 0x1e6d)) /
                               zcc713675e6((double)zca7520bb04->crf + z475da5d694);
}
bool_e VCEncInitRc(vcencRateControl_s *zca7520bb04, u32 zcb3d5e8dbc)
{
    rcVirtualBuffer_s *z019b8df027 = &zca7520bb04->virtualBuffer;
    i32 i;
#if defined(zedac41198c) && (zc970c5211f == z1d365f3798)
    if (!z1d365f3798)
        z1d365f3798 = fopen("\x72\x63\x2e\x74\x72\x63", "\x77\x74");
#endif
    if ((zca7520bb04->qpMax > ((0x386 + 8469 - 0x2468) << QP_FRACTIONAL_BITS))) {
        return ENCHW_NOK;
    }
    zca7520bb04->zdfb346795b = (((i64)rcCalculate(z019b8df027->bitRate, zca7520bb04->outRateDenom,
                                                  zca7520bb04->outRateNum)) *
                                    (0x1ed + 1125 - 0x5ee) +
                                zca7520bb04->picArea / (0x1c6b + 895 - 0x1fe8)) /
                               zca7520bb04->picArea;
    z6770053a09(zca7520bb04);
    zca7520bb04->z2aab5d849e = (0x21cf + 492 - 0x23ba);
    zca7520bb04->zeb1320bacc = (0xebb + 3454 - 0x1c39);
    zca7520bb04->picSkipAllowed = (0x70c + 667 - 0x9a6);
    if (zca7520bb04->pass == (0x752 + 6406 - 0x2057)) {
        zca7520bb04->rcMode = VCE_RC_CQP;
    } else {
#if (0x98d + 3545 - 0x1766)
        zca7520bb04->rcMode = VCE_RC_CVBR;
        if (z019b8df027->bufferSize && z019b8df027->maxBitRate == z019b8df027->bitRate)
            zca7520bb04->rcMode = VCE_RC_CBR;
        else if (zca7520bb04->vbr)
            zca7520bb04->rcMode = VCE_RC_VBR;
#endif
    }
    if (zca7520bb04->qpHdr == (-(0x1d9 + 3781 - 0x109d) << QP_FRACTIONAL_BITS)) {
        i32 z02dd2a3fe6 =
            rcCalculate(z019b8df027->bitRate, zca7520bb04->outRateDenom, zca7520bb04->outRateNum);
        zca7520bb04->qpHdr = zca7520bb04->picRc ? ze173611d5a(z02dd2a3fe6, zca7520bb04->picArea)
                                                : (QP_DEFAULT << QP_FRACTIONAL_BITS);
        zca7520bb04->qpHdr = zca7520bb04->picRc
                                 ? MAX(zca7520bb04->qpHdr, (QP_DEFAULT << QP_FRACTIONAL_BITS) -
                                                               zca7520bb04->intraQpDelta)
                                 : (QP_DEFAULT << QP_FRACTIONAL_BITS);
        z09ffe405ea(zca7520bb04);
        zca7520bb04->z44de60b69c = zca7520bb04->qpHdr;
        if ((zca7520bb04->z44de60b69c) >= ((0x827 + 314 - 0x94f) << QP_FRACTIONAL_BITS)) {
            zca7520bb04->z44de60b69c -= ((0x1397 + 1426 - 0x1917) << QP_FRACTIONAL_BITS);
        } else {
            zca7520bb04->z44de60b69c = (0xad1 + 785 - 0xde2);
        }
    } else {
        i32 z02dd2a3fe6 =
            rcCalculate(z019b8df027->bitRate, zca7520bb04->outRateDenom, zca7520bb04->outRateNum);
        zca7520bb04->z44de60b69c = ze173611d5a(z02dd2a3fe6, zca7520bb04->picArea);
        if ((zca7520bb04->z44de60b69c) >= ((0x1a9d + 488 - 0x1c73) << QP_FRACTIONAL_BITS)) {
            zca7520bb04->z44de60b69c -= ((0x425 + 795 - 0x72e) << QP_FRACTIONAL_BITS);
        } else {
            zca7520bb04->z44de60b69c = (0x56d + 6301 - 0x1e0a);
        }
    }
    if ((zca7520bb04->qpHdr > zca7520bb04->qpMax) || (zca7520bb04->qpHdr < zca7520bb04->qpMin)) {
        return ENCHW_NOK;
    }
    if (zca7520bb04->hrd == ENCHW_YES) {
        zca7520bb04->picRc = ENCHW_YES;
    }
    zca7520bb04->zea3862b025 = zca7520bb04->ctbPerPic * zca7520bb04->ctbSize *
                               zca7520bb04->ctbSize * (0x1f71 + 1814 - 0x2684) /
                               (0x9d2 + 726 - 0xca6);
    zca7520bb04->frameCoded = ENCHW_YES;
    zca7520bb04->sliceTypeCur = I_SLICE;
    zca7520bb04->sliceTypePrev = P_SLICE;
    zca7520bb04->qpHdrPrev = zca7520bb04->qpHdr;
    zca7520bb04->fixedQp = zca7520bb04->qpHdr;
    zca7520bb04->z8fd7bcaec1 = zca7520bb04->qpHdr;
    z019b8df027->bitPerPic =
        rcCalculate(z019b8df027->bitRate, zca7520bb04->outRateDenom, zca7520bb04->outRateNum);
    zca7520bb04->z1e137903f2.z31c3ec84f4 = (0xb3c + 4906 - 0x1e66);
    zca7520bb04->z1e137903f2.zf8a3f36c10 = (0xad + 1065 - 0x4d6);
    zca7520bb04->z52fad3c87c = (0xf7b + 4290 - 0x203d);
    zca7520bb04->z2b59435d98 = zca7520bb04->qpHdr;
    zca7520bb04->z93e1c9ca47 = (0x185 + 8105 - 0x212e);
    if (!zcb3d5e8dbc)
        return ENCHW_OK;
    zca7520bb04->zf9d3566790 = zca7520bb04->bitrateWindow;
    z019b8df027->zc0a193821d = zca7520bb04->bitrateWindow;
    zca7520bb04->z29e41b4870 = zca7520bb04->z3c5c469fd0 = zca7520bb04->bitrateWindow;
    zca7520bb04->zc3e0c52022 =
        zca7520bb04->bitrateWindow * zca7520bb04->outRateDenom / zca7520bb04->outRateNum;
    if (zca7520bb04->zc3e0c52022 < (0x475 + 8120 - 0x242c))
        zca7520bb04->zc3e0c52022 = (0x12dd + 1744 - 0x19ac);
    zca7520bb04->targetPicSize = (0x81f + 3469 - 0x15ac);
    zca7520bb04->z3eab678f73 = (0x2f4 + 434 - 0x4a6);
    zca7520bb04->zc7d8469149 = (0x18a8 + 1934 - 0x2036);
    zca7520bb04->zc7008a3cc6 = (0x5c2 + 7309 - 0x224f);
    zca7520bb04->z8e4b0bbb41 = (0x15f0 + 3450 - 0x236a);
    zca7520bb04->ze5fe0d2d6b = (0x2027 + 1725 - 0x26e4);
#if VBR_RC
    zca7520bb04->zf066713d8c = (0xa64 + 6123 - 0x224f);
    zca7520bb04->zd99b97e997 = (0x106 + 6031 - 0x1895);
    zca7520bb04->zbd6d50ffdd = (0x183d + 108 - 0x18a9);
    zca7520bb04->zc9ed7a8697 = NORMAL_SCENE;
    zca7520bb04->z5f310a70ab = (0x1a7b + 1263 - 0x1f6a);
#endif
    zca7520bb04->ze173381e96 = (0xe87 + 1909 - 0x15fc);
    zca7520bb04->ze41cb9116e = (0x13b0 + 165 - 0x1455);
    zca7520bb04->za25e347240 = (0x103a + 3827 - 0x1f2d);
    zca7520bb04->zf0e7d7a43a = (0x23bb + 546 - 0x25dd);
    z019b8df027->z1f9e750b2c = (0x1942 + 2242 - 0x2204);
    z019b8df027->realBitCnt = (0x12b3 + 3565 - 0x20a0);
    z019b8df027->zbe9fd58c6a = (0x122f + 5256 - 0x26b7);
    zca7520bb04->z1c7bacc73e = (0xda6 + 4564 - 0x1f7a);
    zca7520bb04->z3c9e80fceb = (0x8f8 + 608 - 0xb58);
    zca7520bb04->zafb762023b.zff13b54c4f = zca7520bb04->zafb762023b.count = (0xb23 + 3154 - 0x1775);
    zca7520bb04->zafb762023b.z57f8526067 = zca7520bb04->outRateNum;
    zca7520bb04->zafb762023b.zb2975ef616 = zca7520bb04->outRateDenom;
    if (zca7520bb04->outRateDenom)
        zca7520bb04->zafb762023b.length =
            MAX(LEAST_MONITOR_FRAME, MIN(zca7520bb04->monitorFrames, z2caa41c7fe));
    else
        zca7520bb04->zafb762023b.length = z2caa41c7fe;
    zca7520bb04->z5bd36220d1.zff13b54c4f = zca7520bb04->z5bd36220d1.count = (0x6d + 4564 - 0x1241);
    zca7520bb04->z5bd36220d1.length =
        MAX(LEAST_MONITOR_FRAME,
            MIN(zca7520bb04->monitorFrames / (0x14a + 7381 - 0x1e1d), z2caa41c7fe));
    zca7520bb04->virtualBuffer.ze8bd0d9c56 = rcCalculate(
        zca7520bb04->virtualBuffer.bitRate,
        (0x215 + 6559 - 0x1b50) + zca7520bb04->f_tolMovingBitRate, (0x22c8 + 403 - 0x23f7));
    zca7520bb04->minPicSize = (0x2f0 + 5912 - 0x1a08);
    zca7520bb04->maxPicSize = (0x58f + 2898 - 0x10e1);
    zca7520bb04->z0a1ab5b842 = (0x1a + 6069 - 0x17cf);
    if (z019b8df027->bufferSize) {
        z019b8df027->bucketFullness =
            rcCalculate(z019b8df027->bufferSize, z3c34408299, (0x4b9 + 8204 - 0x2461));
        if (zca7520bb04->hrd) {
            zca7520bb04->zcbf5f92f04 =
                rcCalculate(90000, z019b8df027->bufferSize, z019b8df027->bitRate);
            zca7520bb04->zdeb37127ce =
                rcCalculate(90000, z019b8df027->bucketFullness, z019b8df027->bitRate);
            zca7520bb04->z29350a2390 = zca7520bb04->zcbf5f92f04 - zca7520bb04->zdeb37127ce;
#ifdef zedac41198c
            zca7520bb04->z792101456d = z019b8df027->bufferSize;
            zca7520bb04->z6e3dcebb58 = (0x1565 + 4036 - 0x2529);
#endif
            zca7520bb04->sei.icrd = (u32)zca7520bb04->zdeb37127ce;
            zca7520bb04->sei.icrdo = (u32)zca7520bb04->z29350a2390;
            zca7520bb04->zf062627859 = z019b8df027->bitPerPic;
        }
        z019b8df027->bucketFullness = z019b8df027->bucketLevel =
            z019b8df027->bufferSize - z019b8df027->bucketFullness;
    }
    zca7520bb04->complexity = (0xbdf + 5077 - 0x1fa8);
    zca7520bb04->rcPicComplexity = zca7520bb04->complexity * zca7520bb04->ctbPerPic *
                                   (zca7520bb04->ctbSize / (0x412 + 8882 - 0x26bc)) *
                                   (zca7520bb04->ctbSize / (0x1336 + 4114 - 0x2340));
    zca7520bb04->z9942fdcdc6 = (0xc91 + 4826 - 0x1f6b);
    zca7520bb04->inputSceneChange = (0x117b + 4076 - 0x2167);
    if (IS_CTBRC_FOR_BITRATE(zca7520bb04->ctbRc)) {
        ctbRateControl_s *z28c1bac32b = &(zca7520bb04->ctbRateCtrl);
        i32 z93c6eaeb00 =
            ((0x674 + 7451 - 0x238e) << (0xb31 + 2801 - 0x1610)) - (0x1ae6 + 1672 - 0x216d);
        i32 z92c6fd986d =
            ((0x13f + 6304 - 0x19de) << (0xa1b + 4628 - 0x1c1f)) - (0x995 + 3630 - 0x17c2);
        for (i = (0x931 + 6794 - 0x23bb); i < (0xdb7 + 938 - 0x115e); i++)
            z28c1bac32b->models[i].xMin = (0xaec + 7331 - 0x1f8f);
        z28c1bac32b->rowFactor = (((0x240c + 164 - 0x24af) << CTB_RC_ROW_FACTOR_FIXP) +
                                  zca7520bb04->ctbCols / (0x885 + 6091 - 0x204e)) /
                                 zca7520bb04->ctbCols;
        z28c1bac32b->qpStep = MIN(z93c6eaeb00, z28c1bac32b->qpStep);
        z28c1bac32b->rowFactor = MIN(z92c6fd986d, z28c1bac32b->rowFactor);
    }
    zca7520bb04->z247948ead7 = .0f;
    if (zca7520bb04->pass == (0x1d08 + 314 - 0x1e40) &&
        zca7520bb04->crf >= (0xce4 + 1389 - 0x1251)) {
        z50e433b3c6(zca7520bb04);
    }
    ze10b04996e(zca7520bb04);
    return ENCHW_OK;
}
#define z080c95e230 (0xb16 + 6182 - 0x233c)
static i32 ze173611d5a(i32 zdfcc1a3d2b, i32 z2ca8f76d00)
{
    const i32 z691bea8d6d[(0x9f6 + 4373 - 0x1b09)][(0xbf1 + 2181 - 0x1452)] = {
        {(0xae8 + 2126 - 0x1326),  (0x1c1 + 3521 - 0xf6f),   (0x17e3 + 1743 - 0x1e9b),
         (0x102d + 1777 - 0x1703), (0x1522 + 1181 - 0x199f), (0xfa3 + 2598 - 0x19a5),
         (0x180c + 2321 - 0x20f5), (0x814 + 6532 - 0x216c),  (0x430 + 4007 - 0x13a4),
         (0xde7 + 4985 - 0x2126),  (0x19d1 + 209 - 0x1a61),  (0x17c4 + 2846 - 0x229a),
         (0x27c + 4474 - 0x13a2),  (0x112a + 877 - 0x1437),  (0x1a64 + 1429 - 0x1f8d),
         (0x16c + 6612 - 0x1ac9),  (0x4da + 3918 - 0x139e),  (0x1ba8 + 48 - 0x1b3c),
         (0x2c7 + 406 - 0x3af),    (0x87a + 3186 - 0x142c),  (0x6f6 + 1669 - 0xc9c),
         (0x146f + 608 - 0x15d2),  (0x1ab3 + 618 - 0x1c00),  (0x4aa + 2995 - 0xf23),
         (0x36a + 7161 - 0x1e06),  (0xc29 + 6769 - 0x251a),  (0x501 + 1978 - 0xb18),
         (0x1bac + 3265 - 0x26a8), (0x1ce6 + 2084 - 0x2313), (0x1402 + 1912 - 0x1951),
         (0x1657 + 2352 - 0x1d2c), (0x104b + 1496 - 0x1396), 719,
         (0x8a3 + 6611 - 0x1f66),  (0x1b49 + 3293 - 0x24c6), 2147483647},
        {(0xe2b + 1705 - 0x14a1),  (0x154a + 3573 - 0x230d), (0x1775 + 361 - 0x18ad),
         (0xf0f + 897 - 0x1260),   (0x13d7 + 4718 - 0x2616), (0x37 + 1213 - 0x4c6),
         (0x262 + 3185 - 0xea6),   (0x541 + 3345 - 0x1226),  (0x9a5 + 1042 - 0xd8c),
         (0x912 + 5545 - 0x1e91),  (0x1031 + 5864 - 0x26f0), (0xbdd + 6040 - 0x234d),
         (0xa09 + 5678 - 0x2010),  (0x861 + 2599 - 0x1262),  (0x1d19 + 478 - 0x1ed2),
         (0x669 + 7609 - 0x23fe),  (0x53d + 1350 - 0xa60),   (0x562 + 4590 - 0x172e),
         (0x11a + 6568 - 0x1aa1),  (0x1021 + 2282 - 0x18eb), (0x24e3 + 72 - 0x250c),
         (0xc23 + 2695 - 0x168c),  (0x195c + 2871 - 0x2476), (0x42b + 7896 - 0x22e7),
         (0x5b3 + 1129 - 0xa01),   (0x1680 + 470 - 0x183c),  (0xcac + 4458 - 0x1dfd),
         (0x186c + 2504 - 0x221c), (0x559 + 5894 - 0x1c48),  (0x12d1 + 1783 - 0x19b2),
         (0x35b + 6614 - 0x1d1c),  (0x73 + 4645 - 0x1284),   (0xb2a + 6736 - 0x2567),
         (0x1396 + 706 - 0x1646),  (0xad6 + 1855 - 0x1204),  (0x151d + 317 - 0x164a)}};
    const i32 z2d4808aec1 = 20000;
    i32 i = -(0x153d + 4484 - 0x26c0);
    i64 z59dad1ade3 = (i64)zdfcc1a3d2b;
    z2ca8f76d00 >>= (0x11a0 + 3586 - 0x1f9a);
    z59dad1ade3 >>= (0xe51 + 1827 - 0x156f);
    if (!z59dad1ade3)
        return (0x803 + 5709 - 0x1e1d) << QP_FRACTIONAL_BITS;
    z59dad1ade3 *= z2ca8f76d00 + (0x268 + 4024 - 0x1126);
    ASSERT(z2ca8f76d00 > (0x1700 + 3929 - 0x2659));
    ASSERT(z59dad1ade3 > (0x125f + 2446 - 0x1bed));
    z59dad1ade3 /=
        (0x1913 + 3346 - 0x24c7) + ((0x19a + 1878 - 0x8ed) * z2ca8f76d00) / (0xc37 + 4410 - 0x1d6d);
    z59dad1ade3 = rcCalculate((i32)z59dad1ade3, z2d4808aec1, z2ca8f76d00 << (0x1b4 + 3052 - 0xd9a));
    while ((z691bea8d6d[(0xa50 + 3253 - 0x1705)][++i] - z080c95e230) < z59dad1ade3)
        (void)(0x3df + 2128 - 0xc2e);
    return z691bea8d6d[(0xa3a + 3212 - 0x16c5)][i] << QP_FRACTIONAL_BITS;
}
u32 z580c5b15ed(vcencRateControl_s *zca7520bb04, u32 z1c7bacc73e)
{
    const u8 filler[] = {(0x1a2c + 3291 - 0x2707), (0xa91 + 1337 - 0xfc1),  (0x37c + 1832 - 0xaa4),
                         (0x72a + 5622 - 0x1d17),  (0x9cb + 118 - 0xa38),   (0x976 + 1925 - 0x10f2),
                         (0x82 + 7290 - 0x1cfc),   (0xdb6 + 2109 - 0x15f1), (0xcd4 + 2157 - 0x153f),
                         (0xc2a + 5551 - 0x21d9)};
    u32 zca2dd6da46;
    if (zca7520bb04->zab659326f4 == (u32)(-(0x4a9 + 2217 - 0xd51))) {
        zca7520bb04->zab659326f4 = sizeof(filler) / sizeof(*filler) - (0x3a1 + 4367 - 0x14af);
    }
    zca2dd6da46 = zca7520bb04->zab659326f4;
    if (z1c7bacc73e != (0x14d6 + 2499 - 0x1e99) &&
        ((z1c7bacc73e % (0x42f + 7207 - 0x1fd6)) == (0xc5b + 5168 - 0x208b))) {
        zca2dd6da46++;
    }
    zca2dd6da46 %= sizeof(filler) / sizeof(*filler);
    if (zca2dd6da46 != zca7520bb04->zab659326f4) {
        zca7520bb04->zab659326f4 = zca2dd6da46;
        return filler[zca2dd6da46] + (0xae3 + 3985 - 0x1a73);
    }
    return (0x1e5 + 5497 - 0x175e);
}
static i32 z91c793fa15(vcencRateControl_s *zca7520bb04, i32 zeabf8072f6, true_e hrd)
{
    rcVirtualBuffer_s *z019b8df027 = &zca7520bb04->virtualBuffer;
    i32 target;
    z019b8df027->z1f9e750b2c += zeabf8072f6;
    while (z019b8df027->z1f9e750b2c >= z019b8df027->timeScale) {
        z019b8df027->z1f9e750b2c -= z019b8df027->timeScale;
        if (z019b8df027->realBitCnt < (zebe6047df4 + z019b8df027->bitRate))
            z019b8df027->realBitCnt = zebe6047df4;
        else
            z019b8df027->realBitCnt -= z019b8df027->bitRate;
        if (z019b8df027->bucketLevel < (zebe6047df4 + z019b8df027->bitRate))
            z019b8df027->bucketLevel = zebe6047df4;
        else
            z019b8df027->bucketLevel -= z019b8df027->bitRate;
        z019b8df027->z11b549eb01++;
        z019b8df027->z0d777460a4 =
            z019b8df027->bitRate + z019b8df027->realBitCnt / z019b8df027->z11b549eb01;
    }
    z019b8df027->zbe9fd58c6a =
        rcCalculate(z019b8df027->bitRate, z019b8df027->z1f9e750b2c, z019b8df027->timeScale);
    if (z019b8df027->bufferSize) {
        i32 bucketFullness = z019b8df027->bucketLevel - z019b8df027->zbe9fd58c6a;
        if (hrd && RC_CBR_HRD) {
            z019b8df027->bucketFullness = z019b8df027->bucketLevel - z019b8df027->zbe9fd58c6a;
        } else {
            z019b8df027->bucketFullness = z019b8df027->bucketLevel - z019b8df027->zbe9fd58c6a;
            if (z019b8df027->bucketFullness < (0x6f1 + 574 - 0x92f)) {
                z019b8df027->bucketLevel = z019b8df027->zbe9fd58c6a;
                z019b8df027->bucketFullness = (0x10c1 + 1794 - 0x17c3);
            } else if (z019b8df027->bucketFullness > z019b8df027->bufferSize) {
                z019b8df027->bucketLevel = z019b8df027->zbe9fd58c6a + z019b8df027->bufferSize;
                z019b8df027->bucketFullness = z019b8df027->bufferSize;
            }
        }
    }
    if (z019b8df027->realBitCnt > 536870911)
        z019b8df027->realBitCnt = 536870911;
    if (z019b8df027->realBitCnt < -536870911)
        z019b8df027->realBitCnt = -536870911;
    target = z019b8df027->zbe9fd58c6a - z019b8df027->realBitCnt;
    i32 zd2bd409b79 = z019b8df027->bitRate * (0xcd + 7102 - 0x1c88) / (0x214 + 7944 - 0x2118);
    zca7520bb04->zeb1320bacc = target >= zd2bd409b79;
    if (target > 536870911)
        target = 536870911;
    if (target < -536870911)
        target = -536870911;
    return target;
}
i32 VCEncAfterPicRc(vcencRateControl_s *zca7520bb04, u32 nonZeroCnt, u32 ze3947b4c8e, u32 qpSum,
                    u32 z1217f7c48b)
{
    rcVirtualBuffer_s *z019b8df027 = &zca7520bb04->virtualBuffer;
    i32 bitPerPic = zca7520bb04->virtualBuffer.bitPerPic;
    i32 z02dd2a3fe6, stat, zb95ce05d28 = (i32)ze3947b4c8e * (0x1ab + 6324 - 0x1a57);
    i32 z2b50a19ee4, z98f635968d, ze046ec2811, realBitCnt, z2cec3e6703;
    i32 z3e4a822d42, z00f292cd3b, i;
    i32 zcdcf09b2fe = (0xc6c + 5641 - 0x2275);
    i32 z54cdd83c1d;
    i32 z44b93390c8 = zca7520bb04->ze5fe0d2d6b;
    zca7520bb04->qpSum = (i32)qpSum;
    zca7520bb04->z1217f7c48b = (i32)z1217f7c48b;
    zca7520bb04->zecc8b26b90 =
        z1217f7c48b
            ? (float)qpSum / z1217f7c48b
            : (float)qpSum / (zca7520bb04->ctbPerPic * zca7520bb04->ctbSize * zca7520bb04->ctbSize /
                              (0xed5 + 2330 - 0x17e7) / (0xcd1 + 470 - 0xe9f));
    zca7520bb04->ze5fe0d2d6b = zb95ce05d28;
    zca7520bb04->nonZeroCnt = nonZeroCnt;
    zca7520bb04->ze84c721aa9 += zb95ce05d28;
    zca7520bb04->z1c7bacc73e++;
    zca7520bb04->z0a1ab5b842 += zb95ce05d28;
    if (zca7520bb04->predId == P_SLICE || zca7520bb04->predId == I_SLICE) {
        zca7520bb04->zf066713d8c = zca7520bb04->zc7008a3cc6;
        zca7520bb04->z3eab678f73 = zca7520bb04->targetPicSize;
        zca7520bb04->zc7008a3cc6 = (0x190c + 1908 - 0x2080);
        zca7520bb04->z8e4b0bbb41 = (0x111c + 745 - 0x1405);
    }
    zca7520bb04->zc7008a3cc6 += zb95ce05d28;
    zca7520bb04->z8e4b0bbb41++;
    if (zca7520bb04->pass == (0xe25 + 3754 - 0x1cce))
        return (0x58d + 998 - 0x973);
    if (IS_CTBRC_FOR_BITRATE(zca7520bb04->ctbRc)) {
        if (zca7520bb04->ctbRateCtrl.qpSumForRc) {
            float z75fd21f429 =
                (zca7520bb04->ctbRateCtrl.qpSumForRc * 1.0 / zca7520bb04->ctbPerPic) *
                ((0xd9a + 6097 - 0x256a) << QP_FRACTIONAL_BITS);
            i32 z27e3958c6a =
                zca7520bb04->qpHdrPrev &
                (((0x190d + 2014 - 0x20ea) << QP_FRACTIONAL_BITS) - (0xdf5 + 4350 - 0x1ef2));
            zca7520bb04->qpHdrPrev = (i32)z75fd21f429 + z27e3958c6a;
            zca7520bb04->qpHdrPrev =
                MIN(zca7520bb04->qpHdrPrev, (0x1533 + 2664 - 0x1f68) << QP_FRACTIONAL_BITS);
        }
        i32 zad092a5d4c =
            zca7520bb04->predId < (0x77 + 8653 - 0x2241) ? zca7520bb04->predId : B_SLICE;
        SWAP(zca7520bb04->ctbRateCtrl.ctbMemCurAddr,
             zca7520bb04->ctbRateCtrl.models[zad092a5d4c].ctbMemPreAddr, ptr_t);
        SWAP(zca7520bb04->ctbRateCtrl.ctbMemCurVirtualAddr,
             zca7520bb04->ctbRateCtrl.models[zad092a5d4c].ctbMemPreVirtualAddr, u32 *);
    }
    if (zca7520bb04->pass != (0x1bc3 + 119 - 0x1c38)) {
        zca7520bb04->pass1CurCost = zca7520bb04->picArea;
        if (zca7520bb04->predId != I_SLICE)
            z2089ed76c2(zca7520bb04, zca7520bb04->PBFrame4NRdCost);
    }
    z62ee9d4307(zca7520bb04, zcc713675e6(zd125839e6a(zca7520bb04->qpHdrPrev)),
                zca7520bb04->pass1CurCost, zca7520bb04->ze5fe0d2d6b, zca7520bb04->qpHdrPrev);
    if (zca7520bb04->predId == P_SLICE) {
        zca7520bb04->za25e347240 += zca7520bb04->qpHdrPrev;
        zca7520bb04->zf0e7d7a43a++;
    }
    if (zca7520bb04->pass == (0x2c2 + 7799 - 0x2137) &&
        zca7520bb04->crf >= (0x1628 + 393 - 0x17b1)) {
        if (zca7520bb04->sliceTypeCur == I_SLICE) {
            int z7850137e45 = zca7520bb04->qpHdr >> QP_FRACTIONAL_BITS;
            double z27e3958c6a = (zca7520bb04->qpHdr & (0x1b27 + 1957 - 0x21cd)) /
                                 ((0xc4c + 2096 - 0x147b) << QP_FRACTIONAL_BITS);
            double zaab93973b8 = z7850137e45 + z27e3958c6a;
            if (zca7520bb04->z2b0accbf8b > (0x18b9 + 1805 - 0x1fc6)) {
                zca7520bb04->z2b0accbf8b = (zca7520bb04->z2b0accbf8b * zca7520bb04->z02f70a8bf0 +
                                            (int)(zca7520bb04->pass1CurCost)) /
                                           (zca7520bb04->z02f70a8bf0 + (0xa77 + 5479 - 0x1fdd));
                zca7520bb04->z37c52f3b35 =
                    (zca7520bb04->z37c52f3b35 * zca7520bb04->z02f70a8bf0 + zaab93973b8) /
                    (zca7520bb04->z02f70a8bf0 + (0x1840 + 3594 - 0x2649));
            } else {
                zca7520bb04->z2b0accbf8b = (int)(zca7520bb04->pass1CurCost);
                zca7520bb04->z37c52f3b35 = zaab93973b8;
            }
            zca7520bb04->z02f70a8bf0++;
        }
    }
    if (zca7520bb04->sliceTypeCur != I_SLICE) {
        zca7520bb04->z52fad3c87c =
            ((0x1458 + 381 - 0x15d3) * zca7520bb04->ze5fe0d2d6b *
             (zf47a134a71[(zca7520bb04->qpHdr * (0x541 + 2944 - 0x10b7)) >> QP_FRACTIONAL_BITS] >>
              QP_FRACTIONAL_BITS)) >>
            (0x1545 + 2195 - 0x1dd6);
    } else {
        zca7520bb04->z2b59435d98 = zca7520bb04->qpHdrPrev;
        zca7520bb04->z93e1c9ca47 = zb95ce05d28;
    }
    if (zca7520bb04->targetPicSize) {
        z02dd2a3fe6 = ((zb95ce05d28 - zca7520bb04->targetPicSize) * (0xe21 + 2597 - 0x17e2)) /
                      zca7520bb04->targetPicSize;
    } else {
        z02dd2a3fe6 = (0x6bb + 6455 - 0x1ff2);
    }
    zbd530d7c11(&zca7520bb04->zafb762023b, zb95ce05d28);
    if (zca7520bb04->sliceTypeCur != I_SLICE) {
        z8b44f88b8d(&zca7520bb04->z5bd36220d1, zca7520bb04->intraCu8Num, zca7520bb04->skipCu8Num,
                    zca7520bb04->PBFrame4NRdCost);
        zca7520bb04->ze173381e96 += zca7520bb04->qpHdrPrev;
        zca7520bb04->ze41cb9116e++;
    }
    zca7520bb04->z3a2cd96342[zca7520bb04->predId].z9b4d1c2963 = zca7520bb04->qpHdrPrev;
    zca7520bb04->z3a2cd96342[zca7520bb04->predId].z922e2b332f = zca7520bb04->ze5fe0d2d6b;
    zca7520bb04->z3a2cd96342[zca7520bb04->predId].z47856f228a = zca7520bb04->targetPicSize;
    zca7520bb04->inputSceneChange = (0x1c5a + 1574 - 0x2280);
    if (zca7520bb04->sliceTypeCur == I_SLICE)
        zca7520bb04->z9942fdcdc6 = (0x242 + 6948 - 0x1d66);
    if (zca7520bb04->sliceTypeCur != I_SLICE)
        ze5478205f0(zca7520bb04, zca7520bb04->nonZeroCnt);
    if (zca7520bb04->picSkipAllowed && (zca7520bb04->hrd == ENCHW_YES) &&
        (zb95ce05d28 > (z019b8df027->bufferSize - z019b8df027->bucketFullness))) {
        zca7520bb04->frameCoded = ENCHW_NO;
        zca7520bb04->sliceTypePrev = zca7520bb04->sliceTypeCur;
        return VCENCRC_OVERFLOW;
    } else {
        i32 z2715ab4c99 = zb95ce05d28;
        if ((zca7520bb04->rcMode == VCE_RC_VBR || zca7520bb04->vbr) && zca7520bb04->zeb1320bacc &&
            (zca7520bb04->qpHdr <= zca7520bb04->qpMin) &&
            (z2715ab4c99 < zca7520bb04->virtualBuffer.bitPerPic)) {
            z2715ab4c99 = zca7520bb04->virtualBuffer.bitPerPic;
        }
        z019b8df027->bucketLevel = CLIP_I32_ADD(z019b8df027->bucketLevel, z2715ab4c99);
        z019b8df027->bucketFullness = CLIP_I32_ADD(z019b8df027->bucketFullness, z2715ab4c99);
        z019b8df027->realBitCnt = CLIP_I32_ADD(z019b8df027->realBitCnt, z2715ab4c99);
    }
    zca7520bb04->sliceTypePrev = zca7520bb04->sliceTypeCur;
#if VBR_RC
    z1f46318dc7(zca7520bb04);
#endif
    if (z019b8df027->bufferSize == (0x42 + 4387 - 0x1165))
        return (0x6c3 + 949 - 0xa78);
    z02dd2a3fe6 = (0xb8f + 3645 - 0x19cc);
    u8 z96bd6a5b87 =
        (zca7520bb04->hrd == ENCHW_YES && RC_CBR_HRD) || (zca7520bb04->fillerData == ENCHW_YES);
    if (z96bd6a5b87) {
        z02dd2a3fe6 = bitPerPic - z019b8df027->bucketFullness;
        if (z02dd2a3fe6 > (0x411 + 5683 - 0x1a44)) {
            z02dd2a3fe6 = (z02dd2a3fe6 + (0xd63 + 6113 - 0x253d)) / (0x309 + 1998 - 0xacf);
            z019b8df027->bucketFullness += z02dd2a3fe6 * (0x133a + 2909 - 0x1e8f);
            z019b8df027->realBitCnt += z02dd2a3fe6 * (0x1eeb + 1325 - 0x2410);
            z019b8df027->bucketLevel += z02dd2a3fe6 * (0x2096 + 108 - 0x20fa);
        }
    }
    if (zca7520bb04->hrd == ENCHW_YES) {
        stat = z019b8df027->bufferSize - z019b8df027->bucketFullness;
        zca7520bb04->zdeb37127ce = rcCalculate(90000, stat, z019b8df027->bitRate);
        zca7520bb04->z29350a2390 = zca7520bb04->zcbf5f92f04 - zca7520bb04->zdeb37127ce;
        zca7520bb04->sei.icrd = (u32)zca7520bb04->zdeb37127ce;
        zca7520bb04->sei.icrdo = (u32)zca7520bb04->z29350a2390;
    }
#ifdef zedac41198c
    if (z019b8df027->bucketFullness < zca7520bb04->z792101456d) {
        zca7520bb04->z792101456d = z019b8df027->bucketFullness;
    }
    if (z019b8df027->bucketFullness > zca7520bb04->z6e3dcebb58) {
        zca7520bb04->z6e3dcebb58 = z019b8df027->bucketFullness;
    }
#endif
    return z02dd2a3fe6;
}
static void z6770053a09(vcencRateControl_s *zca7520bb04)
{
    if (zca7520bb04->hierarchical_bit_allocation_GOP_size < (0x82c + 7746 - 0x266d))
        zca7520bb04->hierarchical_bit_allocation_GOP_size = (0x1220 + 4229 - 0x22a4);
    zca7520bb04->z45813bc4d2 = zca7520bb04->hierarchical_bit_allocation_GOP_size;
}
void z97599c809a(vcencRateControl_s *zca7520bb04)
{
#define z492bef9abc 0.04
    double zaa4daa1798, z2fd9172e8b;
    double z7af60da962 = (double)zca7520bb04->outRateNum / zca7520bb04->outRateDenom;
    zaa4daa1798 = pow(z492bef9abc * z7af60da962, 1.0 - 0.6);
    zaa4daa1798 /= zca7520bb04->z247948ead7;
    z2fd9172e8b = z8ed97f0b4b(zaa4daa1798);
    zca7520bb04->qpHdr = z2fd9172e8b * ((0x1d27 + 2382 - 0x2674) << QP_FRACTIONAL_BITS);
}
i32 ze8f61b72fe(vcencRateControl_s *zca7520bb04, i32 z2fd9172e8b)
{
    rcVirtualBuffer_s *z019b8df027 = &zca7520bb04->virtualBuffer;
    i32 z0414ae75c1 = z019b8df027->bucketFullness;
    i32 maxBitRate = z019b8df027->maxBitRate;
    i32 bufferSize = z019b8df027->bufferSize;
    i32 bufferRate = z019b8df027->bufferRate;
    i32 zda7ed2a8c0 =
        maxBitRate <= z019b8df027->bitRate && zca7520bb04->crf < (0x1488 + 2807 - 0x1f7f);
    i32 z668685ae1c = z2fd9172e8b, zdfcc1a3d2b;
    double za64da23a3b;
    i32 terminate = (0x182 + 906 - 0x50c);
    if (bufferSize == (0x2e5 + 296 - 0x40d) || zca7520bb04->predId == B_SLICE ||
        zca7520bb04->predId == (0x18a5 + 1931 - 0x202d))
        return z2fd9172e8b;
    z2fd9172e8b >>= QP_FRACTIONAL_BITS;
    while (terminate != (0x1022 + 3190 - 0x1c95) && z2fd9172e8b >= (0x1e70 + 1982 - 0x262e) &&
           z2fd9172e8b <= (0x9f9 + 6348 - 0x2292)) {
        i32 zcc1d0b0455 = (0xca5 + 5713 - 0x22f5);
        double zca8d2a0001 = zca7520bb04->pass == (0x15d2 + 2415 - 0x1f3f)
                                 ? zca7520bb04->pass1CurCost
                                 : zca7520bb04->picArea;
        double zdfcc1a3d2b = zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[zca7520bb04->predId]),
                                         zcc713675e6(z2fd9172e8b * 1.0), zca8d2a0001);
        double z5036aac4c8 = z0414ae75c1 + zdfcc1a3d2b - bufferRate;
        if (zca7520bb04->predId == P_SLICE) {
            i32 z3e204aa540 =
                MAX((0xefa + 1617 - 0x154b),
                    zca7520bb04->hierarchical_bit_allocation_GOP_size - (0x1323 + 4255 - 0x23c1));
            i32 predId = z3e204aa540 > (0x422 + 5949 - 0x1b5e) ? (0x13bf + 4097 - 0x23bd) : B_SLICE;
            while (z3e204aa540 && z5036aac4c8 >= (0x7c8 + 4176 - 0x1818) &&
                   z5036aac4c8 <= bufferSize) {
                zcc1d0b0455++;
                zca8d2a0001 = zca7520bb04->pass == (0xde5 + 3833 - 0x1cdc)
                                  ? zca7520bb04->pass1GopCost[predId]
                                  : zca7520bb04->picArea;
                zdfcc1a3d2b = zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[predId]),
                                          zcc713675e6(z2fd9172e8b * 1.0), zca8d2a0001);
                z5036aac4c8 += (zdfcc1a3d2b - bufferRate);
                predId = B_SLICE;
                z3e204aa540--;
            }
        }
        double z7e83f24dee = zca7520bb04->predId == I_SLICE ? 0.9 : 0.5;
        za64da23a3b = CLIP3(bufferSize * z7e83f24dee, bufferSize,
                            z0414ae75c1 - zcc1d0b0455 * bufferRate / (0xd10 + 1974 - 0x14c4));
        if (z5036aac4c8 > za64da23a3b) {
            z2fd9172e8b++;
            terminate |= (0xc4a + 5461 - 0x219e);
            continue;
        }
        za64da23a3b = MIN(bufferSize * 0.0f,
                          z0414ae75c1 + zcc1d0b0455 * bufferRate / (0xf0c + 5000 - 0x2292));
        if (zda7ed2a8c0 && z5036aac4c8 < za64da23a3b) {
            z2fd9172e8b--;
            terminate |= (0x421 + 382 - 0x59d);
            continue;
        }
        break;
    }
    z2fd9172e8b <<= QP_FRACTIONAL_BITS;
    if (!zda7ed2a8c0) {
        z2fd9172e8b = MAX(z2fd9172e8b, z668685ae1c);
    }
    i32 zfa686e19b4 = zca7520bb04->z3a2cd96342[zca7520bb04->predId].z9b4d1c2963 +
                      (zca7520bb04->picQpDeltaMin << QP_FRACTIONAL_BITS);
    z2fd9172e8b = MAX(zfa686e19b4, z2fd9172e8b);
    if (zca7520bb04->pass != (0x327 + 5408 - 0x1845)) {
        i32 zf670f0aaae = (0x341 + 6220 - 0x1b8b);
        zfa686e19b4 = z668685ae1c - (zf670f0aaae << QP_FRACTIONAL_BITS);
        z2fd9172e8b = MAX(zfa686e19b4, z2fd9172e8b);
        i32 z5089412e1d = z668685ae1c + (zf670f0aaae << QP_FRACTIONAL_BITS);
        z2fd9172e8b = MIN(z5089412e1d, z2fd9172e8b);
    }
    z2fd9172e8b = CLIP3(zca7520bb04->qpMin, zca7520bb04->qpMax, z2fd9172e8b);
    return z2fd9172e8b;
}
void z66e07da648(vcencRateControl_s *zca7520bb04)
{
    rcVirtualBuffer_s *z019b8df027 = &zca7520bb04->virtualBuffer;
    i32 z9017401758 = zca7520bb04->maxPicSize;
    i32 zca8d2a0001 = zca7520bb04->pass == (0x714 + 4494 - 0x18a0) ? zca7520bb04->pass1CurCost
                                                                   : zca7520bb04->picArea;
    i32 z07c645501d =
        zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[zca7520bb04->predId]),
                    zcc713675e6(zca7520bb04->qpHdr >> QP_FRACTIONAL_BITS), zca8d2a0001);
    if (zca7520bb04->predId == B_SLICE || zca7520bb04->predId == (0x1e14 + 525 - 0x201e)) {
        while (zca7520bb04->maxPicSize && z07c645501d > zca7520bb04->maxPicSize &&
               zca7520bb04->qpHdr <=
                   (zca7520bb04->qpMax - ((0xa13 + 4125 - 0x1a2f) << QP_FRACTIONAL_BITS))) {
            if (zca7520bb04->zc9ed7a8697 == SIMPLE_SCENE)
                zca7520bb04->zc9ed7a8697 = NORMAL_SCENE;
            zca7520bb04->qpHdr += ((0xad0 + 4132 - 0x1af3) << QP_FRACTIONAL_BITS);
            z07c645501d =
                zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[zca7520bb04->predId]),
                            zcc713675e6(zca7520bb04->qpHdr >> QP_FRACTIONAL_BITS), zca8d2a0001);
        }
    }
    zca7520bb04->targetPicSize = z07c645501d;
    if (zca7520bb04->predId == P_SLICE) {
        i32 z1cdce22f58 = zca7520bb04->targetPicSize;
        i32 z3e204aa540 =
            zca7520bb04->hierarchical_bit_allocation_GOP_size - (0x10c3 + 664 - 0x135a);
        if (z3e204aa540 > (0x16b + 2241 - 0xa2b)) {
            zca8d2a0001 = zca7520bb04->pass == (0x1702 + 3157 - 0x2355)
                              ? zca7520bb04->pass1GopCost[(0xe85 + 5467 - 0x23dd)]
                              : zca7520bb04->picArea;
            z1cdce22f58 +=
                zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[(0xd0f + 5690 - 0x2346)]),
                            zcc713675e6(zca7520bb04->qpHdr >> QP_FRACTIONAL_BITS), zca8d2a0001);
            z3e204aa540--;
        }
        if (z3e204aa540) {
            zca8d2a0001 = zca7520bb04->pass == (0x6e9 + 3770 - 0x15a1)
                              ? zca7520bb04->pass1GopCost[B_SLICE]
                              : zca7520bb04->picArea;
            z1cdce22f58 +=
                zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[B_SLICE]),
                            zcc713675e6(zca7520bb04->qpHdr >> QP_FRACTIONAL_BITS), zca8d2a0001) *
                z3e204aa540;
        }
        if (zca7520bb04->hierarchical_bit_allocation_GOP_size > (0xb08 + 1317 - 0x102c) &&
            z9017401758) {
            if (z1cdce22f58 > (0xf39 + 2262 - 0x180f))
                zca7520bb04->maxPicSize =
                    ((u64)zca7520bb04->maxPicSize) * zca7520bb04->targetPicSize *
                    zca7520bb04->hierarchical_bit_allocation_GOP_size / z1cdce22f58;
            zca7520bb04->maxPicSize = MAX(z9017401758, zca7520bb04->maxPicSize);
            z9017401758 = zca7520bb04->maxPicSize;
        }
    }
    if (z019b8df027->bufferSize) {
        i32 z6256cf588c = (z019b8df027->bufferSize - z019b8df027->bucketFullness) *
                          (zca7520bb04->predId == I_SLICE ? 0.9 : 0.5);
        i32 zd7b699eb36 = z019b8df027->bufferSize * 0.95 - z019b8df027->bucketFullness;
        zca7520bb04->maxPicSize = z019b8df027->bufferRate + MIN(z6256cf588c, zd7b699eb36);
        zca7520bb04->maxPicSize =
            MAX(z019b8df027->bufferRate / (0x192c + 1671 - 0x1fb1), zca7520bb04->maxPicSize);
        if (z9017401758)
            zca7520bb04->maxPicSize = MIN(z9017401758, zca7520bb04->maxPicSize);
        zca7520bb04->minPicSize = (0xf63 + 50 - 0xf95);
    }
    if (zca7520bb04->maxPicSize)
        zca7520bb04->targetPicSize =
            CLIP3(zca7520bb04->minPicSize, zca7520bb04->maxPicSize, zca7520bb04->targetPicSize);
}
void VCEncBeforePicRc(vcencRateControl_s *zca7520bb04, u32 zeabf8072f6, u32 z9acc17595d,
                      bool z2f7fa6af59, struct sw_picture *zea90799120)
{
    rcVirtualBuffer_s *z019b8df027 = &zca7520bb04->virtualBuffer;
    i32 i, z6425650955 = (0xc5c + 3885 - 0x1b88), zed2bcd2b16 = (0x10b9 + 3998 - 0x2057),
           z02dd2a3fe6 = (0xd39 + 24 - 0xd51);
    bool ze450ce840e = HANTRO_FALSE;
    zca7520bb04->frameCoded = ENCHW_YES;
    zca7520bb04->sliceTypeCur = z9acc17595d;
    zca7520bb04->minPicSize = zca7520bb04->maxPicSize = (0x2c5 + 7301 - 0x1f4a);
    if (zca7520bb04->pass == (0x9a3 + 4688 - 0x1bf2)) {
        zca7520bb04->qpHdr = CU_TREE_QP << QP_FRACTIONAL_BITS;
        zca7520bb04->qpHdrPrev = zca7520bb04->qpHdr;
        zca7520bb04->qpSum = (0x92 + 9143 - 0x2449);
        zca7520bb04->qpLastCoded = zca7520bb04->qpHdr;
        zca7520bb04->qpTarget = zca7520bb04->qpHdr;
        zca7520bb04->nonZeroCnt = (0x1249 + 1998 - 0x1a17);
        return;
    }
    zca7520bb04->predId = z3a498c503b(zca7520bb04);
    if (zca7520bb04->predId == I_SLICE || zca7520bb04->predId == P_SLICE)
        zca7520bb04->qpFactor = 0.0;
    if (zca7520bb04->pass == (0x845 + 7401 - 0x252c) && zca7520bb04->crf >= (0x88b + 530 - 0xa9d)) {
        z97599c809a(zca7520bb04);
    } else {
        if (zca7520bb04->z45813bc4d2 != zca7520bb04->hierarchical_bit_allocation_GOP_size)
            z6770053a09(zca7520bb04);
        z02dd2a3fe6 = z91c793fa15(zca7520bb04, (i32)zeabf8072f6, zca7520bb04->hrd);
        for (i = (0x88c + 1730 - 0xf4e); i < z9ae471aa41; i++) {
            zca7520bb04->z1e137903f2.zf596d61938[i] = (0x1f1 + 6285 - 0x1a7e);
        }
        if (z019b8df027->zc0a193821d == (0x1442 + 175 - 0x14f1)) {
            z019b8df027->zc0a193821d = zca7520bb04->zf9d3566790 - (0xffa + 1177 - 0x1492);
        } else {
            z019b8df027->zc0a193821d--;
        }
        if (zca7520bb04->sliceTypeCur != I_SLICE &&
            zca7520bb04->z3c5c469fd0 > (0x3f5 + 1569 - 0xa15) &&
            zca7520bb04->z3c5c469fd0 > zca7520bb04->z29e41b4870) {
            zed2bcd2b16 = z019b8df027->bitPerPic * zca7520bb04->z3c5c469fd0 *
                          z9a356800c4(&zca7520bb04->za8b95563b2, (0x19ff + 1604 - 0x2039)) /
                          (0x4e0 + 4699 - 0x16d7);
            zed2bcd2b16 -= z019b8df027->bitPerPic;
            zed2bcd2b16 /= (zca7520bb04->z3c5c469fd0 - (0x14f7 + 1468 - 0x1ab2));
            zed2bcd2b16 = MAX((0x58 + 7664 - 0x1e48), zed2bcd2b16);
        }
        z02dd2a3fe6 += zed2bcd2b16 * (zca7520bb04->z3c5c469fd0 - zca7520bb04->z29e41b4870);
#ifdef z48cb2a2b74
        z6425650955 =
            MAX(MAX((0xc88 + 4438 - 0x1ddb), zca7520bb04->zf9d3566790 / (0x26d + 6657 - 0x1c68)),
                z019b8df027->zc0a193821d);
#else
        z6425650955 = MAX((0x667 + 7644 - 0x2442), zca7520bb04->zf9d3566790);
#endif
        zca7520bb04->targetPicSize =
            z019b8df027->bitPerPic - zed2bcd2b16 + DIV(z02dd2a3fe6, z6425650955);
        ze450ce840e = (((0xde1 + 2034 - 0x1573) + zca7520bb04->ctbRows * zca7520bb04->ctbSize) >
                       zca7520bb04->targetPicSize)
                          ? HANTRO_TRUE
                          : HANTRO_FALSE;
        zca7520bb04->targetPicSize =
            MAX((0x778 + 4499 - 0x18ab) + zca7520bb04->ctbRows * zca7520bb04->ctbSize,
                zca7520bb04->targetPicSize);
        if (zca7520bb04->picSkipAllowed && zca7520bb04->picSkip)
            z32ae321340(zca7520bb04);
        z1b20e4cee0(zca7520bb04);
        if (ze450ce840e && (zca7520bb04->qpHdr < zca7520bb04->qpHdrPrev) &&
            (zca7520bb04->sliceTypeCur != I_SLICE) && (0x409 + 4364 - 0x1514)) {
            zca7520bb04->qpHdr = MAX(zca7520bb04->z75b9ee3750, zca7520bb04->qpHdr);
        }
    }
    z09ffe405ea(zca7520bb04);
    if (zca7520bb04->sliceTypeCur == I_SLICE) {
        if (zca7520bb04->fixedIntraQp)
            zca7520bb04->qpHdr = zca7520bb04->fixedIntraQp;
        else if (zca7520bb04->sliceTypePrev != I_SLICE) {
            if (zca7520bb04->IFrameQpVisualTuning && (zca7520bb04->picRc == ENCHW_YES))
                zca7520bb04->intraQpDelta =
                    MIN(zca7520bb04->intraQpDelta, -(0x2185 + 1188 - 0x2626) << QP_FRACTIONAL_BITS);
            i32 ze11c1446c2 = zca7520bb04->intraQpDelta;
            if (IS_CTBRC_FOR_QUALITY(zca7520bb04->ctbRc) && zca7520bb04->z1c7bacc73e &&
                (zca7520bb04->pass != (0xa9d + 4799 - 0x1d5a))) {
                i32 complexity =
                    (i32)(zca7520bb04->rcPicComplexity * zca7520bb04->reciprocalOfNumBlk8 + 0.5);
                i32 z9c2b4b1cfe =
                    (MAX(complexity, (0x3b9 + 4769 - 0x1651)) - (0xddb + 2726 - 0x186e))
                    << QP_FRACTIONAL_BITS;
                if (z9c2b4b1cfe < (0x22d5 + 1029 - 0x26da)) {
                    i32 zf5ddef8a94 =
                        ((0x981 + 3573 - 0x175c) << QP_FRACTIONAL_BITS) - zca7520bb04->qpHdr;
                    zf5ddef8a94 = MIN((0x1165 + 4172 - 0x21b1), zf5ddef8a94);
                    z9c2b4b1cfe = MAX(zf5ddef8a94, z9c2b4b1cfe);
                }
                if ((z9c2b4b1cfe > (0x4c8 + 4385 - 0x15e9)) &&
                    (ze11c1446c2 > (0xb8d + 4577 - 0x1d6e)))
                    ze11c1446c2 = MAX(z9c2b4b1cfe, ze11c1446c2);
                else if ((z9c2b4b1cfe < (0x6c7 + 4596 - 0x18bb)) &&
                         (ze11c1446c2 < (0x234 + 7825 - 0x20c5)))
                    ze11c1446c2 = MIN(z9c2b4b1cfe, ze11c1446c2);
                else
                    ze11c1446c2 += z9c2b4b1cfe;
            }
            zca7520bb04->qpHdr += ze11c1446c2;
            if (zca7520bb04->picRc && (zca7520bb04->z5bd36220d1.count != (0x9d1 + 5087 - 0x1db0))) {
                z4fb3eda91c(&zca7520bb04->z5bd36220d1);
                if ((i32)zca7520bb04->z5bd36220d1.zf374f6a90b <=
                        (zca7520bb04->picArea >> (0x185b + 1367 - 0x1dac)) *
                            (0x1e9b + 1348 - 0x23d5) &&
                    zca7520bb04->z5bd36220d1.zc09ddd71e6 <=
                        (zca7520bb04->picArea >> (0x2065 + 1373 - 0x25bc)) * 0.0016 &&
                    (!zca7520bb04->inputSceneChange)) {
                    if (zca7520bb04->u32StaticSceneIbitPercent) {
                        bool z580df2ced7 = HANTRO_FALSE;
                        bool ze065ec8a91 = HANTRO_FALSE;
                        u32 z380b559771 =
                            (u32)((((u64)zca7520bb04->z93e1c9ca47 * zca7520bb04->outRateNum) /
                                   zca7520bb04->outRateDenom / zca7520bb04->z3c5c469fd0) *
                                  (0x481 + 6813 - 0x1eba) / zca7520bb04->virtualBuffer.bitRate);
                        if (z380b559771 >
                            (zca7520bb04->u32StaticSceneIbitPercent + (0x229 + 4090 - 0x1214))) {
                            zca7520bb04->qpHdr = zca7520bb04->z2b59435d98 +
                                                 ((0x12e0 + 5081 - 0x26b7) << QP_FRACTIONAL_BITS);
                            z580df2ced7 = HANTRO_TRUE;
                        } else if (z380b559771 > (zca7520bb04->u32StaticSceneIbitPercent +
                                                  (0x633 + 3283 - 0x1301))) {
                            zca7520bb04->qpHdr = zca7520bb04->z2b59435d98 +
                                                 ((0xf97 + 1207 - 0x144d) << QP_FRACTIONAL_BITS);
                            z580df2ced7 = HANTRO_TRUE;
                        } else if (z380b559771 >=
                                   (zca7520bb04->u32StaticSceneIbitPercent - (0xad1 + 112 - 0xb3c)))
                            zca7520bb04->qpHdr = zca7520bb04->z2b59435d98;
                        else if ((z380b559771 > (zca7520bb04->u32StaticSceneIbitPercent -
                                                 (0x1d38 + 1464 - 0x22e1))) &&
                                 (zca7520bb04->qpHdr >= zca7520bb04->z2b59435d98)) {
                            zca7520bb04->qpHdr = zca7520bb04->z2b59435d98 -
                                                 ((0x2d0 + 7930 - 0x21c9) << QP_FRACTIONAL_BITS);
                            ze065ec8a91 = HANTRO_TRUE;
                        } else if (zca7520bb04->qpHdr >=
                                   (zca7520bb04->z2b59435d98 -
                                    ((0x15ed + 1824 - 0x1d0c) << QP_FRACTIONAL_BITS))) {
                            zca7520bb04->qpHdr = zca7520bb04->z2b59435d98 -
                                                 ((0xcf0 + 4419 - 0x1e31) << QP_FRACTIONAL_BITS);
                            ze065ec8a91 = HANTRO_TRUE;
                        }
                        if (((zca7520bb04->virtualBuffer.realBitCnt -
                              zca7520bb04->virtualBuffer.zbe9fd58c6a) >
                             zca7520bb04->virtualBuffer.bitRate) &&
                            (z580df2ced7 == HANTRO_FALSE))
                            zca7520bb04->qpHdr = zca7520bb04->qpHdr +
                                                 ((0x7ad + 6968 - 0x22e4) << QP_FRACTIONAL_BITS);
                        else if (((zca7520bb04->virtualBuffer.zbe9fd58c6a -
                                   zca7520bb04->virtualBuffer.realBitCnt) >
                                  zca7520bb04->virtualBuffer.bitRate) &&
                                 (ze065ec8a91 == HANTRO_FALSE))
                            zca7520bb04->qpHdr =
                                zca7520bb04->qpHdr - ((0x1c7 + 1052 - 0x5e2) << QP_FRACTIONAL_BITS);
                    }
                }
            }
        }
        if (zca7520bb04->z29e41b4870 >= (0x155c + 1428 - 0x1aef))
            zca7520bb04->z3c5c469fd0 = zca7520bb04->z29e41b4870;
        zca7520bb04->z29e41b4870 = (0xc63 + 5787 - 0x22fd);
    } else {
        zca7520bb04->z29e41b4870++;
        if (zca7520bb04->z29e41b4870 > zca7520bb04->z3c5c469fd0)
            zca7520bb04->z3c5c469fd0 = zca7520bb04->z29e41b4870;
#if (0x1f9 + 842 - 0x542)
        if (zca7520bb04->sliceTypeCur != I_SLICE) {
            if (zca7520bb04->picRc != ENCHW_YES)
                zca7520bb04->qpHdr += zca7520bb04->frameQpDelta;
            if (z2f7fa6af59)
                zca7520bb04->qpHdr += zca7520bb04->longTermQpDelta;
            if (zca7520bb04->qpHdr > ((0x1ff + 8711 - 0x23d3) << QP_FRACTIONAL_BITS))
                zca7520bb04->qpHdr = ((0x1b5b + 1407 - 0x20a7) << QP_FRACTIONAL_BITS);
        }
#endif
    }
    z09ffe405ea(zca7520bb04);
    if (zca7520bb04->virtualBuffer.bufferSize)
        zca7520bb04->qpHdr = ze8f61b72fe(zca7520bb04, zca7520bb04->qpHdr);
    z66e07da648(zca7520bb04);
    zca7520bb04->qpHdrPrev = zca7520bb04->qpHdr;
    if (zca7520bb04->predId == I_SLICE ||
        (zca7520bb04->predId == P_SLICE &&
         zca7520bb04->qpHdr < ((0x192 + 5816 - 0x1817) << QP_FRACTIONAL_BITS)))
        zca7520bb04->qpFactor = 0.0;
    zca7520bb04->qpSum = (0xe9c + 3939 - 0x1dff);
    zca7520bb04->qpLastCoded = zca7520bb04->qpHdr;
    zca7520bb04->qpTarget = zca7520bb04->qpHdr;
    zca7520bb04->nonZeroCnt = (0x54b + 4921 - 0x1884);
    for (i = (0x1f64 + 986 - 0x233e); i < z9ae471aa41; i++) {
    }
    if (zca7520bb04->sliceTypeCur == I_SLICE)
        zca7520bb04->z3c9e80fceb = zca7520bb04->z1c7bacc73e;
    zca7520bb04->sei.crd =
        MAX((0xcd + 9551 - 0x261b), zca7520bb04->z1c7bacc73e - zca7520bb04->z3c9e80fceb);
    if (zea90799120 != NULL)
        zca7520bb04->sei.dod = zea90799120->sps->max_num_reorder_pics[(0xe6a + 2234 - 0x1724)] +
                               zca7520bb04->z3c9e80fceb + zea90799120->poc -
                               zca7520bb04->z1c7bacc73e;
    else
        zca7520bb04->sei.dod = (0xadd + 1890 - 0x123f);
}
void ze5478205f0(vcencRateControl_s *zca7520bb04, i32 nonZeroCnt)
{
    ASSERT(nonZeroCnt <= zca7520bb04->zea3862b025);
    ASSERT(nonZeroCnt >= (0x55a + 5499 - 0x1ad5) &&
           zca7520bb04->zea3862b025 >= (0xa7f + 4264 - 0x1b27));
    if (nonZeroCnt == (0x164 + 8858 - 0x23fe)) {
        nonZeroCnt = (0x182a + 149 - 0x18be);
    }
    zca7520bb04->z199dc1d4e8 = rcCalculate(zca7520bb04->ze5fe0d2d6b,
                                           zca7520bb04->ctbSize * zca7520bb04->ctbSize, nonZeroCnt);
}
void z32ae321340(vcencRateControl_s *zca7520bb04)
{
    rcVirtualBuffer_s *z019b8df027 = &zca7520bb04->virtualBuffer;
    i32 z4c82802d53 = z019b8df027->zbe9fd58c6a - z019b8df027->realBitCnt;
    i32 zed9590cf2e = -z019b8df027->bitPerPic / (0x9b2 + 6815 - 0x244e);
    i32 ze104a7155e = z019b8df027->bitPerPic / (0x18cb + 1040 - 0x1cd8);
    if (((zca7520bb04->picRc == ENCHW_NO) ||
         (z019b8df027->z9b20c7aeb4 == (0x265b + 100 - 0x26bf))) &&
        (z4c82802d53 < zed9590cf2e)) {
        z019b8df027->z9b20c7aeb4++;
    }
    if ((z4c82802d53 > ze104a7155e) && z019b8df027->z9b20c7aeb4 > (0x22e4 + 392 - 0x246c)) {
        z019b8df027->z9b20c7aeb4--;
    }
    if (z019b8df027->zd5c2c0ded9 < z019b8df027->z9b20c7aeb4) {
        z019b8df027->zd5c2c0ded9++;
        zca7520bb04->frameCoded = ENCHW_NO;
    } else {
        z019b8df027->zd5c2c0ded9 = (0x456 + 4999 - 0x17dd);
    }
}
void z1b20e4cee0(vcencRateControl_s *zca7520bb04)
{
    true_e z7fab9beeb1 = ENCHW_YES;
    i32 i, z4442789aec, zd48b1f3b4a, z4ab6c61df7, z6ece3ff382, z98f635968d, z382e7b8fcd,
        z361875baea, z760ecf84d0;
    i32 z2ce9eaeb71;
    i32 z69cd3309a5, za819a76fb2, ze046ec2811;
    z382e7b8fcd = (0x1126 + 1117 - 0x1583);
    if (zca7520bb04->picRc != ENCHW_YES) {
        zca7520bb04->qpHdr = zca7520bb04->fixedQp;
        return;
    }
    if (zca7520bb04->sliceTypeCur == I_SLICE) {
        zca7520bb04->z75b9ee3750 = z2f5e53679d(zca7520bb04);
        zca7520bb04->qpHdr =
            (zca7520bb04->qpHdrPrev + zca7520bb04->z75b9ee3750) / (0x1d70 + 833 - 0x20af);
        if (zca7520bb04->pass == (0x997 + 6202 - 0x21d1) &&
            zca7520bb04->qpHdr > zca7520bb04->z8fd7bcaec1) {
            if (zca7520bb04->qpHdr - zca7520bb04->z8fd7bcaec1 >=
                ((0x1516 + 1521 - 0x1b01) << QP_FRACTIONAL_BITS))
                zca7520bb04->qpHdr =
                    (zca7520bb04->qpHdrPrev + zca7520bb04->z75b9ee3750 + zca7520bb04->z8fd7bcaec1) /
                    (0x986 + 6008 - 0x20fb);
            else
                zca7520bb04->qpHdr =
                    (zca7520bb04->qpHdr + zca7520bb04->z8fd7bcaec1) / (0xf7c + 2007 - 0x1751);
        }
        if (zca7520bb04->z9942fdcdc6 || zca7520bb04->inputSceneChange) {
            i32 z2b42e43bfd =
                ze173611d5a(zca7520bb04->virtualBuffer.bitPerPic, zca7520bb04->picArea);
            zca7520bb04->qpHdr = MAX(z2b42e43bfd, zca7520bb04->qpHdr);
        }
        i32 z3553725f4a = (zca7520bb04->z1c7bacc73e == (0x810 + 3242 - 0x14ba)) &&
                          (zca7520bb04->pass == (0x441 + 1628 - 0xa9b));
        if (z3553725f4a)
            z7fab9beeb1 = ENCHW_NO;
        if (zca7520bb04->sliceTypePrev == I_SLICE || z3553725f4a) {
            zca7520bb04->z8fd7bcaec1 = zca7520bb04->qpHdr = zd401dac647(zca7520bb04, z7fab9beeb1);
            if (z3553725f4a) {
                if (zca7520bb04->IFrameQpVisualTuning) {
                    i32 z7e14a32deb =
                        ze173611d5a(zca7520bb04->virtualBuffer.bitPerPic, zca7520bb04->picArea);
                    if (zca7520bb04->qpHdr > z7e14a32deb)
                        zca7520bb04->qpHdr = ((0x1f8f + 1277 - 0x2489) * zca7520bb04->qpHdr +
                                              (0x121 + 7492 - 0x1e60) * z7e14a32deb) >>
                                             (0x1e4d + 289 - 0x1f6b);
                }
                for (i = (0x35d + 2344 - 0xc85); i < (0x8c0 + 3682 - 0x171e); i++)
                    zca7520bb04->z3a2cd96342[i].z2fd9172e8b = zca7520bb04->qpHdr;
            }
        }
    } else {
        if (VBR_RC == (0x3b6 + 7241 - 0x1ffd) && zca7520bb04->predId == P_SLICE) {
            zc7b4f40dbc(zca7520bb04);
            if (zca7520bb04->zc9ed7a8697 == COMPLEX_SCENE &&
                zca7520bb04->z5f310a70ab > (0xcb5 + 1732 - 0x1379)) {
                i32 z201845d8b2 = zca7520bb04->targetPicSize;
                i32 ze2538c2a88 = MAX(zca7520bb04->bitrateWindow,
                                      zca7520bb04->hierarchical_bit_allocation_GOP_size);
                i32 zc81a731bd6 =
                    zca7520bb04->targetPicSize + zca7520bb04->z5f310a70ab / ze2538c2a88;
                i32 z7b6d44ee57 =
                    (zc81a731bd6 - z201845d8b2) * zca7520bb04->hierarchical_bit_allocation_GOP_size;
                z7b6d44ee57 = MIN(zca7520bb04->z5f310a70ab, z7b6d44ee57);
                zca7520bb04->virtualBuffer.realBitCnt -= z7b6d44ee57;
                zca7520bb04->z5f310a70ab -= z7b6d44ee57;
                zca7520bb04->targetPicSize =
                    MIN((0x29d + 4479 - 0x141a) * z201845d8b2, zc81a731bd6);
            }
        }
        ze046ec2811 = MIN(zca7520bb04->virtualBuffer.bitPerPic, zca7520bb04->i32MaxPicSize);
        ze046ec2811 = (i32)MIN(zca7520bb04->z52fad3c87c, (u32)ze046ec2811);
        za819a76fb2 = ze046ec2811 / (0xdb4 + 4635 - 0x1fc5);
        z69cd3309a5 = MIN(
            (((i64)zca7520bb04->virtualBuffer.ze8bd0d9c56 * zca7520bb04->zafb762023b.zb2975ef616) /
             zca7520bb04->zafb762023b.z57f8526067),
            zca7520bb04->i32MaxPicSize);
        z69cd3309a5 = zf32036a4e1(zca7520bb04, z69cd3309a5);
        z69cd3309a5 = MAX(za819a76fb2, z69cd3309a5);
        zca7520bb04->maxPicSize = z69cd3309a5;
        zca7520bb04->targetPicSize = CLIP3(za819a76fb2, z69cd3309a5, zca7520bb04->targetPicSize);
        if (zca7520bb04->sliceTypeCur == P_SLICE)
            zca7520bb04->targetPicSize = CLIP3(zca7520bb04->minPicSizeP, zca7520bb04->maxPicSizeP,
                                               zca7520bb04->targetPicSize);
        else
            zca7520bb04->targetPicSize = CLIP3(zca7520bb04->minPicSizeB, zca7520bb04->maxPicSizeB,
                                               zca7520bb04->targetPicSize);
        if (zca7520bb04->predId == P_SLICE)
            zca7520bb04->zc7d8469149 =
                zca7520bb04->hierarchical_bit_allocation_GOP_size * zca7520bb04->targetPicSize;
        zca7520bb04->qpHdr = zd401dac647(zca7520bb04, z7fab9beeb1);
    }
}
void z09ffe405ea(vcencRateControl_s *zca7520bb04)
{
    zca7520bb04->qpHdr = MIN(zca7520bb04->qpMax, MAX(zca7520bb04->qpMin, zca7520bb04->qpHdr));
}
i32 rcCalculate(i32 a, i32 b, i32 c)
{
    u32 left = (0xf51 + 1384 - 0x1499);
    u32 right = (0x3e5 + 3684 - 0x1249);
    u32 shift;
    i32 sign = (0xb69 + 3346 - 0x187a);
    i32 z02dd2a3fe6;
    if (a == (0x617 + 6716 - 0x2053) || b == (0x10e8 + 373 - 0x125d)) {
        return (0x4f3 + 4472 - 0x166b);
    } else if ((i64)a * (i64)b < (1LL << (0x1eb0 + 715 - 0x215c)) && c != (0xe3c + 149 - 0xed1)) {
        return (a * b / c);
    }
    if (a < (0x1c10 + 2616 - 0x2648)) {
        sign = -(0x395 + 2294 - 0xc8a);
        a = -a;
    }
    if (b < (0x4f0 + 5301 - 0x19a5)) {
        sign *= -(0x13f5 + 2789 - 0x1ed9);
        b = -b;
    }
    if (c < (0x6e5 + 2443 - 0x1070)) {
        sign *= -(0x19d4 + 777 - 0x1cdc);
        c = -c;
    }
    if (c == (0x12fd + 4106 - 0x2307)) {
        return 2147483647 * sign;
    }
    if (b > a) {
        z02dd2a3fe6 = b;
        b = a;
        a = z02dd2a3fe6;
    }
    for (--left; (((u32)a << left) >> left) != (u32)a; --left)
        ;
    left--;
    while (((u32)b >> right) > (u32)c) {
        right++;
    }
    if (right > left) {
        return 2147483647 * sign;
    } else {
        shift = left - right;
        return (i32)((((u32)a << shift) / (u32)c * (u32)b) >> shift) * sign;
    }
}
i32 z2f5e53679d(vcencRateControl_s *zca7520bb04)
{
    i32 z02dd2a3fe6 = zca7520bb04->qpHdrPrev;
    i32 z4abdf4ac3f = (0x7b8 + 2895 - 0x12a8);
    zca7520bb04->z6f73eb8ac3 = zca7520bb04->ze84c721aa9;
    if ((zca7520bb04->pass == (0x362 + 5122 - 0x1762)) && zca7520bb04->za25e347240 &&
        zca7520bb04->zf0e7d7a43a)
        z02dd2a3fe6 = DIV(zca7520bb04->za25e347240, zca7520bb04->zf0e7d7a43a);
    else if (zca7520bb04->ze173381e96 && zca7520bb04->ze41cb9116e) {
        z02dd2a3fe6 = DIV(zca7520bb04->ze173381e96, zca7520bb04->ze41cb9116e);
    }
    zca7520bb04->zabbbd97b5e =
        DIV(zca7520bb04->ze84c721aa9, (zca7520bb04->ze41cb9116e + (0x1628 + 3446 - 0x239d)));
    if (zca7520bb04->ze84c721aa9) {
#if (0x827 + 2630 - 0x126d)
        i32 z0a2f505b03 =
            rcCalculate(zca7520bb04->z3a2cd96342[I_SLICE].z922e2b332f, z7fdf199e36,
                        zca7520bb04->ctbPerPic * zca7520bb04->ctbSize * zca7520bb04->ctbSize /
                            (0xcb1 + 6763 - 0x270c) / (0x506 + 1674 - 0xb80));
        i32 zd36105b99b =
            rcCalculate(z0a2f505b03,
                        zca7520bb04->ctbPerPic * zca7520bb04->ctbSize * zca7520bb04->ctbSize /
                            (0xdf5 + 1641 - 0x144e) / (0x13 + 9688 - 0x25db),
                        z7fdf199e36) *
            (0xc6 + 9514 - 0x258c);
#else
        i32 zd36105b99b = zca7520bb04->z3a2cd96342[I_SLICE].z922e2b332f * (0xbf + 6398 - 0x1959);
#endif
        zd36105b99b = DIV(zd36105b99b, zca7520bb04->ze84c721aa9);
        zd36105b99b = MIN(z4abdf4ac3f, zd36105b99b);
        zd8c80794d2(&zca7520bb04->za8b95563b2, z02dd2a3fe6, zd36105b99b);
    }
    zca7520bb04->ze173381e96 = (0x53d + 6104 - 0x1d15);
    zca7520bb04->ze41cb9116e = (0x10fb + 3977 - 0x2084);
    zca7520bb04->ze84c721aa9 = (0xa25 + 452 - 0xbe9);
    zca7520bb04->za25e347240 = (0x20b0 + 339 - 0x2203);
    zca7520bb04->zf0e7d7a43a = (0x4c2 + 8363 - 0x256d);
    return z02dd2a3fe6;
}
static i32 zd401dac647(vcencRateControl_s *zca7520bb04, true_e z7fab9beeb1)
{
    i64 z0f87cb9cb6 = (0xf04 + 2386 - 0x1856), z02dd2a3fe6 = (0x147b + 2658 - 0x1edd), z62eff1e472,
        z712fbcb763 = 0x7fffffffff;
    i32 z8ad09e4259 = (0x55b + 275 - 0x66e),
        zaa1eadc676 = zca7520bb04->z3a2cd96342[zca7520bb04->predId].z9b4d1c2963,
        z2fd9172e8b = zca7520bb04->z3a2cd96342[zca7520bb04->predId].z9b4d1c2963;
    if (zca7520bb04->pass == (0xf59 + 4002 - 0x1ef9)) {
        i32 id = zca7520bb04->predId;
        i32 z2e1662c0b7 = (0x1b3a + 861 - 0x1e97);
        i32 zb4bfe34b86 = (id == I_SLICE) && (zca7520bb04->z1c7bacc73e == (0x1bb3 + 1381 - 0x2118));
        i32 zb603eb6858 = id == I_SLICE ? (zca7520bb04->intraQpDelta >> QP_FRACTIONAL_BITS)
                                        : (0x147a + 2855 - 0x1fa1);
    z773cb21382:
        zaa1eadc676 = z2fd9172e8b = zb93ff510f9(zca7520bb04);
#if VBR_RC
        if (zb4bfe34b86 == (0x84d + 4264 - 0x18f5))
            z2fd9172e8b =
                z4bfe0f8f2a(zca7520bb04, z2fd9172e8b, zca7520bb04->z3a2cd96342[id].z9b4d1c2963);
#endif
        double zc18e3a3afd =
            zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[id]),
                        zcc713675e6(((z2fd9172e8b >> QP_FRACTIONAL_BITS) + zb603eb6858) * 1.0),
                        zca7520bb04->pass1CurCost);
#if VBR_RC
        i32 z194d71fceb = z2fd9172e8b >> QP_FRACTIONAL_BITS;
        if (zca7520bb04->initialQpTuning && zb4bfe34b86 == (0xb53 + 5075 - 0x1f25) &&
            z2e1662c0b7 == (0x791 + 1617 - 0xde2) && z194d71fceb <= (0x1094 + 5248 - 0x24f6)) {
            if (zc18e3a3afd > (0x8fa + 1105 - 0xd3b) * zca7520bb04->virtualBuffer.bitPerPic) {
                z57f9202139(zca7520bb04, (0xb41 + 3146 - 0x178a));
                z2e1662c0b7 = (0x7d2 + 4087 - 0x17c8);
            } else if (zc18e3a3afd >
                       (0x825 + 6972 - 0x2355) * zca7520bb04->virtualBuffer.bitPerPic) {
                z57f9202139(zca7520bb04, (0xda2 + 1519 - 0x1391));
                z2e1662c0b7 = (0x1ea2 + 1718 - 0x2557);
            }
            if (z2e1662c0b7)
                goto z773cb21382;
        }
#endif
        zca7520bb04->z3a2cd96342[id].z9b4d1c2963 =
            (zca7520bb04->z3a2cd96342[id].z2fd9172e8b >= (0x1871 + 3421 - 0x25ce))
                ? zca7520bb04->z3a2cd96342[id].z2fd9172e8b
                : z2fd9172e8b;
        if (zc18e3a3afd > (0xbb6 + 2167 - 0x142d))
            zca7520bb04->targetPicSize = zc18e3a3afd;
        if ((id == B_SLICE) || (id == (0x10c7 + 4900 - 0x23e8)))
            z7fab9beeb1 = ENCHW_NO;
        goto z3f1bf6c557;
    }
    if (zca7520bb04->z3a2cd96342[zca7520bb04->predId].count <= 1.0) {
        zca7520bb04->z3a2cd96342[zca7520bb04->predId].z9b4d1c2963 = z2fd9172e8b;
        return z2fd9172e8b;
    }
    if (zca7520bb04->predId == B_SLICE || zca7520bb04->predId == (0x1ecd + 246 - 0x1fc0)) {
        return zca7520bb04->z3a2cd96342[P_SLICE].z2fd9172e8b;
    }
    z2fd9172e8b = z1ef68cc885(zca7520bb04, NULL, NULL, zca7520bb04->targetPicSize)
                  << QP_FRACTIONAL_BITS;
    if ((zca7520bb04->rcMode == VCE_RC_CVBR))
        z2fd9172e8b = z4bfe0f8f2a(zca7520bb04, z2fd9172e8b,
                                  zca7520bb04->z3a2cd96342[zca7520bb04->predId].z9b4d1c2963);
    i32 z7ca7bd71c2 = zca7520bb04->predId == I_SLICE
                          ? (0x2570 + 331 - 0x26bb)
                          : zca7520bb04->z3a2cd96342[zca7520bb04->predId].z922e2b332f;
    i32 z5fb09a326f = zca7520bb04->predId == I_SLICE
                          ? (0x2399 + 354 - 0x24fb)
                          : zca7520bb04->z3a2cd96342[zca7520bb04->predId].z47856f228a;
    i32 z216b981cb8 =
        zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[zca7520bb04->predId]),
                    zcc713675e6(z2fd9172e8b >> QP_FRACTIONAL_BITS), zca7520bb04->picArea);
    if (z7ca7bd71c2 && z5fb09a326f) {
        if (((z216b981cb8 >= z7ca7bd71c2) &&
             (z2fd9172e8b >= zca7520bb04->z3a2cd96342[zca7520bb04->predId].z9b4d1c2963)) ||
            ((z216b981cb8 <= z7ca7bd71c2) &&
             (z2fd9172e8b <= zca7520bb04->z3a2cd96342[zca7520bb04->predId].z9b4d1c2963))) {
            z2fd9172e8b = zca7520bb04->z3a2cd96342[zca7520bb04->predId].z9b4d1c2963;
            if (z216b981cb8 > z7ca7bd71c2 * 1.1 &&
                zca7520bb04->z1c7bacc73e > (0x14f0 + 3176 - 0x211c) &&
                zca7520bb04->z0a1ab5b842 <
                    zca7520bb04->virtualBuffer.bitPerPic * zca7520bb04->z1c7bacc73e * 0.8) {
                z2fd9172e8b -= ((0x6f0 + 4352 - 0x17ef) << QP_FRACTIONAL_BITS);
            }
        }
    }
z3f1bf6c557:
    z2fd9172e8b = CLIP3((0x19bf + 1072 - 0x1def), 13056, z2fd9172e8b);
    i32 z2b42e43bfd = (0x10d9 + 428 - 0x1285);
    if (zca7520bb04->inputSceneChange) {
        z2b42e43bfd = ze173611d5a(zca7520bb04->virtualBuffer.bitPerPic, zca7520bb04->picArea);
        z2fd9172e8b = MAX(z2fd9172e8b, z2b42e43bfd);
    }
    if (z7fab9beeb1) {
        i32 zfa686e19b4 = zca7520bb04->z3a2cd96342[zca7520bb04->predId].z9b4d1c2963 +
                          (zca7520bb04->picQpDeltaMin << QP_FRACTIONAL_BITS);
        i32 z5089412e1d = zca7520bb04->z3a2cd96342[zca7520bb04->predId].z9b4d1c2963 +
                          (zca7520bb04->picQpDeltaMax << QP_FRACTIONAL_BITS);
        z2fd9172e8b = CLIP3(zfa686e19b4, z5089412e1d, z2fd9172e8b);
    }
    if (IS_CTBRC_FOR_QUALITY(zca7520bb04->ctbRc) == (0x207 + 3242 - 0xeb1))
        z2fd9172e8b = ((z2fd9172e8b + ((0x753 + 3824 - 0x1642)
                                       << (QP_FRACTIONAL_BITS - (0x658 + 5425 - 0x1b88)))) >>
                       QP_FRACTIONAL_BITS)
                      << QP_FRACTIONAL_BITS;
    return z2fd9172e8b;
}
static i32 z9a356800c4(za506561fab *p, i32 n)
{
    i32 i;
    i64 sum = (0x868 + 1785 - 0xf61);
    i32 zff13b54c4f = p->zff13b54c4f;
    if (!p->len)
        return (0x485 + 7168 - 0x2085);
    if (n == -(0x8b4 + 2222 - 0x1161) || n > p->len)
        n = p->len;
    i = n;
    while (i--) {
        if (zff13b54c4f)
            zff13b54c4f--;
        else
            zff13b54c4f = p->len - (0x577 + 7900 - 0x2452);
        sum += p->zdfcc1a3d2b[zff13b54c4f];
        if (sum < (0xe9b + 388 - 0x101f)) {
            return z66d3e33abc / (n - i);
        }
    }
    return DIV(sum, n);
}
static void zd8c80794d2(za506561fab *p, i32 z2fd9172e8b, i32 zdfcc1a3d2b)
{
    const i32 zd194a14423 = zdb70b37658;
    i32 z02dd2a3fe6 = p->zff13b54c4f;
    p->z8ad09e4259 = z2fd9172e8b;
    p->zcb89df56bf[z02dd2a3fe6] =
        zf47a134a71[((z2fd9172e8b * (0x1415 + 4302 - 0x24d9)) >> QP_FRACTIONAL_BITS)];
    p->zdfcc1a3d2b[z02dd2a3fe6] = zdfcc1a3d2b;
    z63fdc3a8e2("\x75\x70\x64\x20\x74\x61\x62\x6c\x65\x3a\x20\x71\x73\x20\x25\x69\x20\x20\x62\x69"
                "\x74\x73\x20\x25\x69\x20\x20\x71\x70\x20\x25\x64\x20\x25\x32\x2e\x32\x66"
                "\n",
                p->zcb89df56bf[z02dd2a3fe6], zdfcc1a3d2b, z2fd9172e8b, z2fd9172e8b / 256.0);
    if (++p->zff13b54c4f >= zd194a14423) {
        p->zff13b54c4f = (0x7a0 + 3365 - 0x14c5);
    }
    if (p->len < zd194a14423) {
        p->len++;
    }
}
static void zbd530d7c11(zcf4bacd786 *zafb762023b, i32 z3524d4da5f)
{
    zafb762023b->frame[zafb762023b->zff13b54c4f++] = z3524d4da5f;
    if (zafb762023b->zff13b54c4f == zafb762023b->length)
        zafb762023b->zff13b54c4f = (0x16f4 + 344 - 0x184c);
    if (zafb762023b->count < zafb762023b->length)
        zafb762023b->count++;
}
static i32 z17ef4a756a(zcf4bacd786 *zafb762023b)
{
    i32 i;
    unsigned long long sum = (0x34a + 4 - 0x34e);
    for (i = (0x2091 + 1209 - 0x254a); i < zafb762023b->count; i++) {
        sum += zafb762023b->frame[i];
    }
    if (!zafb762023b->zb2975ef616)
        return (0x1589 + 851 - 0x18dc);
    sum = sum / zafb762023b->count;
    return sum * (zafb762023b->z57f8526067 + zafb762023b->zb2975ef616 - (0x11a0 + 3322 - 0x1e99)) /
           zafb762023b->zb2975ef616;
}
static void z8b44f88b8d(z5a5950b51a *zafb762023b, u32 intraCu8Num, u32 skipCu8Num,
                        u32 PBFrame4NRdCost)
{
    zafb762023b->intraCu8Num[zafb762023b->zff13b54c4f] = intraCu8Num;
    zafb762023b->skipCu8Num[zafb762023b->zff13b54c4f] = skipCu8Num;
    zafb762023b->PBFrame4NRdCost[zafb762023b->zff13b54c4f] = PBFrame4NRdCost;
    zafb762023b->zff13b54c4f++;
    if (zafb762023b->zff13b54c4f == zafb762023b->length)
        zafb762023b->zff13b54c4f = (0x4f2 + 2857 - 0x101b);
    if (zafb762023b->count < zafb762023b->length)
        zafb762023b->count++;
}
static void z4fb3eda91c(z5a5950b51a *zafb762023b)
{
    i32 i;
    unsigned long long zfce45b26a0 = (0xac3 + 2795 - 0x15ae), zb14e367da8 = (0x569 + 8595 - 0x26fc),
                       zbc381a88c6 = (0x1c59 + 2518 - 0x262f);
    for (i = (0x8ec + 6594 - 0x22ae); i < zafb762023b->count; i++) {
        zfce45b26a0 += zafb762023b->intraCu8Num[i];
        zb14e367da8 += zafb762023b->skipCu8Num[i];
        zbc381a88c6 += zafb762023b->PBFrame4NRdCost[i];
    }
    zafb762023b->zc09ddd71e6 = zfce45b26a0 / zafb762023b->count;
    zafb762023b->z59fac279de = zb14e367da8 / zafb762023b->count;
    zafb762023b->zf374f6a90b = zbc381a88c6 / zafb762023b->count;
}
static i32 za9481c4a4e(zcf4bacd786 *zafb762023b)
{
    i32 i = (0x928 + 896 - 0xca8);
    i32 sum = (0x11b6 + 5297 - 0x2667);
    i32 zdeb9d9dedd;
    zdeb9d9dedd = zafb762023b->zff13b54c4f - (0x1c11 + 648 - 0x1e98);
    if (zdeb9d9dedd < (0x1474 + 3258 - 0x212e))
        zdeb9d9dedd = zafb762023b->length - (0x15c3 + 2206 - 0x1e60);
    while ((0x37c + 5801 - 0x1a24)) {
        if (i == zafb762023b->count - (0x4a9 + 137 - 0x531))
            break;
        sum += zafb762023b->frame[zdeb9d9dedd];
        zdeb9d9dedd--;
        if (zdeb9d9dedd < (0x10d1 + 5138 - 0x24e3))
            zdeb9d9dedd = zafb762023b->length - (0x205 + 1770 - 0x8ee);
        i++;
    }
    return sum;
}
static i32 zf32036a4e1(vcencRateControl_s *zca7520bb04, i32 z4986b5c1c6)
{
    zcf4bacd786 *zafb762023b = &(zca7520bb04->zafb762023b);
    i32 zc81a731bd6 = zca7520bb04->targetPicSize;
    i32 ze8ebfc3480 = zca7520bb04->monitorFrames;
    i32 i = (0x18db + 2269 - 0x21b8);
    i32 sum = (0x1e87 + 1301 - 0x239c);
    i32 len = ze8ebfc3480 - (0x208a + 1621 - 0x26de);
    i32 zdfcc1a3d2b = z4986b5c1c6;
    i32 zdf9678b348 = z4986b5c1c6 * ze8ebfc3480;
    i32 zff13b54c4f = zafb762023b->zff13b54c4f;
    i32 z02dd2a3fe6;
    i32 z0e7f3a94f9 = MIN(z4986b5c1c6, zc81a731bd6) / (0xc79 + 3503 - 0x1a26);
    for (i = len; i > (0x21b + 4766 - 0x14b9); i--) {
        if (zafb762023b->count < (len - i + (0x932 + 1275 - 0xe2c)))
            break;
        zff13b54c4f--;
        if (zff13b54c4f < (0x3ad + 6208 - 0x1bed))
            zff13b54c4f = zafb762023b->length - (0x1cbb + 320 - 0x1dfa);
        sum += zafb762023b->frame[zff13b54c4f];
        z02dd2a3fe6 = (zdf9678b348 - sum) / i;
        zdfcc1a3d2b = MIN(z02dd2a3fe6, zdfcc1a3d2b);
        if (zdfcc1a3d2b <= z0e7f3a94f9)
            break;
    }
    zdfcc1a3d2b = MAX(z0e7f3a94f9, zdfcc1a3d2b);
    return zdfcc1a3d2b;
}
void ze10b04996e(vcencRateControl_s *zca7520bb04)
{
    double z9b2b71f215[(0x12ea + 528 - 0x14f6)] = {
        (0x3a7 + 1047 - 0x7be),
    };
    double z01bc086aef = 0.5;
    i32 za3503be3f8 = (0xa35 + 1015 - 0xe28);
    if (zca7520bb04->pass == (0xe4b + 5756 - 0x24c5)) {
        if (zca7520bb04->visualLmdTuning) {
            z9b2b71f215[B_SLICE] = 0.35;
            z9b2b71f215[P_SLICE] = 0.7;
            z9b2b71f215[I_SLICE] = 1.0;
            z9b2b71f215[(0x7cf + 2556 - 0x11c8)] = 0.4;
        } else {
            z9b2b71f215[B_SLICE] = 0.2;
            z9b2b71f215[P_SLICE] = 0.8;
            z9b2b71f215[I_SLICE] = 1.2;
            z9b2b71f215[(0x46d + 2828 - 0xf76)] = 0.35;
        }
        z01bc086aef = 1.0;
        za3503be3f8 = (zca7520bb04->rcMode == VCE_RC_CBR || zca7520bb04->rcMode == VCE_RC_ABR)
                          ? (0x1225 + 1770 - 0x190b)
                          : (0xd6a + 1416 - 0x12f0);
    } else {
        z9b2b71f215[B_SLICE] = 0.25;
        z9b2b71f215[P_SLICE] = 1.0;
        z9b2b71f215[I_SLICE] = 4.0;
        z9b2b71f215[(0x15fd + 717 - 0x18c7)] = 0.5;
        z01bc086aef = 0.5;
        za3503be3f8 = (zca7520bb04->rcMode == VCE_RC_CBR || zca7520bb04->rcMode == VCE_RC_ABR)
                          ? (0x289 + 7813 - 0x2106)
                          : (0x129 + 3126 - 0xd5b);
    }
    for (i32 i = (0x1a4f + 2225 - 0x2300); i < (0x66b + 5930 - 0x1d91); i++) {
        zca7520bb04->z3a2cd96342[i].z497bd1f85d = z9b2b71f215[i];
        zca7520bb04->z3a2cd96342[i].z712cfca15b =
            zca7520bb04->z3a2cd96342[i].z497bd1f85d / za3503be3f8;
        zca7520bb04->z3a2cd96342[i].z01bc086aef = z01bc086aef;
        zca7520bb04->z3a2cd96342[i].count = 1.0;
        zca7520bb04->z3a2cd96342[i].offset = 0.0;
        zca7520bb04->z3a2cd96342[i].z2fd9172e8b = -(0x257 + 3967 - 0x11d5);
        zca7520bb04->z3a2cd96342[i].z9b4d1c2963 = zca7520bb04->qpHdr;
        zca7520bb04->z3a2cd96342[i].z861e0d65a9 = (0xb16 + 4800 - 0x1dd6);
        zca7520bb04->z3a2cd96342[i].z3af6f68c9f = 0.5;
        zca7520bb04->z3a2cd96342[i].z1b1f42bca4 = (0x85b + 1778 - 0xf4d);
        zca7520bb04->z3a2cd96342[i].z255fad4eff = (0xa4c + 2384 - 0x139c);
        zca7520bb04->z3a2cd96342[i].z80c9bc5d34 = 0.999;
        zca7520bb04->z3a2cd96342[i].z38e5d4431c = (0x1b02 + 2473 - 0x24ab);
        zca7520bb04->z3a2cd96342[i].zca8d2a0001 = (0x127d + 4123 - 0x2298);
        zca7520bb04->z3a2cd96342[i].z922e2b332f = (0x329 + 6114 - 0x1b0b);
        zca7520bb04->z3a2cd96342[i].z47856f228a = (0x882 + 6317 - 0x212f);
    }
}
#if VBR_RC
void z57f9202139(vcencRateControl_s *zca7520bb04, i32 z158c94c7a8)
{
    const double z03a6252a0e[(0x1ff6 + 122 - 0x206c)] = {0.5, 1.0, 1.5, 0.75};
    const double zfaddf9acfd[(0x1bf4 + 395 - 0x1d7b)] = {0.5, 1.2, 2.0, 0.75};
    const double *z9b2b71f215 = z158c94c7a8 ? zfaddf9acfd : z03a6252a0e;
    zca7520bb04->z3a2cd96342[B_SLICE].z497bd1f85d = z9b2b71f215[B_SLICE];
    zca7520bb04->z3a2cd96342[P_SLICE].z497bd1f85d = z9b2b71f215[P_SLICE];
    zca7520bb04->z3a2cd96342[I_SLICE].z497bd1f85d = z9b2b71f215[I_SLICE];
    zca7520bb04->z3a2cd96342[(0x874 + 46 - 0x89f)].z497bd1f85d =
        z9b2b71f215[(0x2436 + 524 - 0x263f)];
    for (i32 i = (0x1ccc + 2120 - 0x2514); i < (0xa1b + 6805 - 0x24ac); i++)
        zca7520bb04->z3a2cd96342[i].z497bd1f85d = z9b2b71f215[i];
}
#endif
void z2089ed76c2(vcencRateControl_s *zca7520bb04, double zf70a512cde)
{
    zba7eff2a5d *p = &(zca7520bb04->z3a2cd96342[zca7520bb04->predId]);
    double zca8d2a0001 = zf70a512cde / zca7520bb04->picArea;
    p->z1b1f42bca4 *= p->z3af6f68c9f;
    p->z861e0d65a9 *= p->z3af6f68c9f;
    p->z1b1f42bca4++;
    p->z861e0d65a9 += zca8d2a0001;
    p->z38e5d4431c *= p->z80c9bc5d34;
    p->z255fad4eff *= p->z80c9bc5d34;
    p->z38e5d4431c++;
    p->z255fad4eff += zca8d2a0001;
    p->zca8d2a0001 = zca8d2a0001;
}
void z62ee9d4307(vcencRateControl_s *zca7520bb04, double zaa4daa1798, double zf70a512cde,
                 double zdfcc1a3d2b, i32 z2fd9172e8b)
{
    if (zf70a512cde < (0x456 + 4919 - 0x1783))
        return;
    zba7eff2a5d *p = &(zca7520bb04->z3a2cd96342[zca7520bb04->predId]);
    const double range = (0x1215 + 1110 - 0x1669);
    double zfe03046730 = p->z497bd1f85d / p->count;
    double z282862f198 = p->offset / p->count;
    double zda07093c4f =
        MAX((zdfcc1a3d2b * zaa4daa1798 - z282862f198) / zf70a512cde, p->z712cfca15b);
    double z3ff899e42a = CLIP3(zfe03046730 / range, zfe03046730 * range, zda07093c4f);
    double zc35ce38ae1 = zdfcc1a3d2b * zaa4daa1798 - z3ff899e42a * zf70a512cde;
    if (zc35ce38ae1 >= (0xa95 + 243 - 0xb88))
        zda07093c4f = z3ff899e42a;
    else
        zc35ce38ae1 = (0x60d + 1928 - 0xd95);
    p->count *= p->z01bc086aef;
    p->z497bd1f85d *= p->z01bc086aef;
    p->offset *= p->z01bc086aef;
    p->count++;
    p->z497bd1f85d += zda07093c4f;
    p->offset += zc35ce38ae1;
    p->z2fd9172e8b = z2fd9172e8b;
}
double zc7f7a46e4e(zba7eff2a5d *p, double zaa4daa1798, double zf70a512cde)
{
    return (p->z497bd1f85d * zf70a512cde + p->offset) / (zaa4daa1798 * p->count);
}
double z8ed97f0b4b(double zea9fae6ac8)
{
    return 12.0 + 6.0 * (double)LOG2(zea9fae6ac8 / 0.85);
}
double zcc713675e6(double z2fd9172e8b)
{
#ifdef z8432f9496f
    return z65557a7fa6[CLIP3((0x109f + 3787 - 0x1f6a), (0x1740 + 2249 - 0x1fd6), (int)z2fd9172e8b)];
#else
    return 0.85 * pow(2.0, (z2fd9172e8b - 12.0) / 6.0);
#endif
}
double zd125839e6a(i32 z2fd9172e8b)
{
    return z2fd9172e8b * 1.0 / ((0x115b + 4571 - 0x2335) << QP_FRACTIONAL_BITS);
}
i32 z3a498c503b(vcencRateControl_s *zca7520bb04)
{
    i32 id = zca7520bb04->sliceTypeCur;
    if (zca7520bb04->sliceTypeCur == B_SLICE) {
        if ((i32)zca7520bb04->gopPoc ==
            (zca7520bb04->hierarchical_bit_allocation_GOP_size - (0xdf3 + 5862 - 0x24d8))) {
            id = P_SLICE;
        } else if ((zca7520bb04->hierarchical_bit_allocation_GOP_size > (0xda + 2035 - 0x8cb)) &&
                   ((i32)zca7520bb04->gopPoc ==
                    (zca7520bb04->hierarchical_bit_allocation_GOP_size / (0xe7 + 8768 - 0x2325) -
                     (0x1014 + 3839 - 0x1f12)))) {
            id = (0x50c + 6865 - 0x1fda);
        }
    }
    return id;
}
double zb51d26c94c(vcencRateControl_s *zca7520bb04, double *z88c68737a0, i32 *zc8ac131109,
                   i32 zaa4daa1798, double zc81a731bd6)
{
    i32 i, z1d61421f0c = (0x182d + 2210 - 0x20cf);
    double zdfcc1a3d2b = (0x11e8 + 4942 - 0x2536), z62eff1e472 = (0xcf6 + 5267 - 0x2189);
    if (zca7520bb04->pass != (0x1930 + 2507 - 0x22f9)) {
        zdfcc1a3d2b = zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[zca7520bb04->predId]),
                                  zcc713675e6(zaa4daa1798 * 1.0), zca7520bb04->picArea);
        z1d61421f0c++;
        if (zca7520bb04->predId == P_SLICE) {
            i32 z3e204aa540 =
                zca7520bb04->hierarchical_bit_allocation_GOP_size - (0xe33 + 6196 - 0x2666);
            if (z3e204aa540 > (0x709 + 3761 - 0x15b9)) {
                zdfcc1a3d2b += zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[(0xbe4 + 4192 - 0x1c41)]),
                                           zcc713675e6(zaa4daa1798 * 1.0), zca7520bb04->picArea);
                z1d61421f0c++;
                z3e204aa540--;
            }
            if (z3e204aa540) {
                zdfcc1a3d2b += zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[B_SLICE]),
                                           zcc713675e6(zaa4daa1798 * 1.0), zca7520bb04->picArea) *
                               z3e204aa540;
                z1d61421f0c += z3e204aa540;
            }
        }
        goto z79ccb35f34;
    }
    if (zca7520bb04->sliceTypeCur == I_SLICE) {
        double z10f3e9c6a8 = (0x420 + 4768 - 0x16c0), z79c46d409f = (0x528 + 34 - 0x54a);
        i32 z00b449cc49 = (0x1b94 + 939 - 0x1f3f), za22f522a67 = (0x460 + 6995 - 0x1fb3);
        for (i = (0x8ab + 6826 - 0x2355); i < (0x9ba + 5416 - 0x1ede); i++) {
            z1d61421f0c += zc8ac131109[i];
            if (zc8ac131109[i]) {
                i32 zfacfea343c = zaa4daa1798;
                if (i == I_SLICE && RC_IFRAME_EST_WITH_DELTA) {
                    zfacfea343c = zaa4daa1798 + (zca7520bb04->intraQpDelta >> QP_FRACTIONAL_BITS);
                    zfacfea343c =
                        CLIP3((0x7c9 + 7099 - 0x2384), (0xe1d + 2978 - 0x198c), zfacfea343c);
                }
                double zc0b3525e52 = zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[i]),
                                                 zcc713675e6(zfacfea343c * 1.0), z88c68737a0[i]) *
                                     zc8ac131109[i];
                if (i == I_SLICE) {
                    z10f3e9c6a8 += zc0b3525e52;
                    za22f522a67 += zc8ac131109[i];
                } else {
                    z79c46d409f += zc0b3525e52;
                    z00b449cc49 += zc8ac131109[i];
                }
            }
        }
        if (z00b449cc49 &&
            (z00b449cc49 < za22f522a67 * (zca7520bb04->z3c5c469fd0 - (0x6d8 + 4903 - 0x19fe)))) {
            if (za22f522a67)
                zdfcc1a3d2b = z10f3e9c6a8 / za22f522a67;
            zdfcc1a3d2b +=
                (z79c46d409f / z00b449cc49) * (zca7520bb04->z3c5c469fd0 - (0x182 + 2580 - 0xb95));
            z1d61421f0c = zca7520bb04->z3c5c469fd0;
        } else
            zdfcc1a3d2b = z10f3e9c6a8 + z79c46d409f;
    } else {
        for (i = (0x49d + 3590 - 0x12a3); i < (0x3d + 1095 - 0x480); i++) {
            if (zc8ac131109[i] && (i != I_SLICE)) {
                z1d61421f0c += zc8ac131109[i];
                zdfcc1a3d2b += zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[i]),
                                           zcc713675e6(zaa4daa1798 * 1.0), z88c68737a0[i]) *
                               zc8ac131109[i];
            }
        }
    }
z79ccb35f34:
    zc81a731bd6 *= z1d61421f0c;
    if (zc81a731bd6) {
        z62eff1e472 = zdfcc1a3d2b - zc81a731bd6;
        if (zaa4daa1798 == (0x826 + 2077 - 0x1010) && zdfcc1a3d2b > zc81a731bd6 &&
            zca7520bb04->qpFactor <= 1.0) {
            zca7520bb04->qpFactor = zdfcc1a3d2b / zc81a731bd6;
            zca7520bb04->qpFactor = MIN(zca7520bb04->qpFactor, 1.4);
        }
    }
    return z62eff1e472;
}
i32 z1ef68cc885(vcencRateControl_s *zca7520bb04, double *z88c68737a0, i32 *zc8ac131109,
                double zc81a731bd6)
{
    double za3db60a8ec;
    double z62eff1e472, z2a133108c6;
    i32 i;
    i32 zaa4daa1798 = zca7520bb04->z3a2cd96342[zca7520bb04->predId].z2fd9172e8b;
    zaa4daa1798 = (zaa4daa1798 < (0x404 + 3485 - 0x11a1)) ? (0x5e6 + 5323 - 0x1a97)
                                                          : (zaa4daa1798 >> QP_FRACTIONAL_BITS);
    za3db60a8ec = zb51d26c94c(zca7520bb04, z88c68737a0, zc8ac131109, zaa4daa1798, zc81a731bd6);
    z2a133108c6 = ABS(za3db60a8ec);
    if (z2a133108c6 == (0x4b8 + 8476 - 0x25d4))
        return zaa4daa1798;
    i32 step =
        (za3db60a8ec > (0xf78 + 1219 - 0x143b)) ? (0x1b72 + 2063 - 0x2380) : -(0x3d3 + 209 - 0x4a3);
    for (zaa4daa1798 = zaa4daa1798 + step;
         (zaa4daa1798 >= (0x114b + 5049 - 0x2504)) && (zaa4daa1798 <= (0xfc5 + 5135 - 0x23a1));
         zaa4daa1798 += step) {
        za3db60a8ec = zb51d26c94c(zca7520bb04, z88c68737a0, zc8ac131109, zaa4daa1798, zc81a731bd6);
        z62eff1e472 = ABS(za3db60a8ec);
        if (z62eff1e472 >= z2a133108c6) {
            zaa4daa1798 -= step;
            break;
        }
        z2a133108c6 = z62eff1e472;
    }
    zaa4daa1798 = CLIP3((0x13b + 7552 - 0x1ebb), (0x17fa + 1008 - 0x1bb7), zaa4daa1798);
    if (zca7520bb04->pass != (0x132f + 910 - 0x16bb)) {
        double zf70a512cde = zca7520bb04->picArea;
        i32 z58dd7f3c9f = (0x1d6a + 1710 - 0x2418), z842c23cfdc = (0x1c43 + 1266 - 0x2135),
            z6b74454f6c = (0xc7c + 3444 - 0x19f0);
        if (zca7520bb04->predId == P_SLICE) {
            z58dd7f3c9f = zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[zca7520bb04->predId]),
                                      zcc713675e6(zaa4daa1798 * 1.0), zf70a512cde);
            i32 z3e204aa540 =
                zca7520bb04->hierarchical_bit_allocation_GOP_size - (0x8ed + 1366 - 0xe42);
            if (z3e204aa540 > (0x870 + 3806 - 0x174d)) {
                z6b74454f6c += zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[(0xb90 + 4140 - 0x1bb9)]),
                                           zcc713675e6(zaa4daa1798 * 1.0), zf70a512cde);
                z3e204aa540--;
            }
            if (z3e204aa540)
                z842c23cfdc += zc7f7a46e4e(&(zca7520bb04->z3a2cd96342[B_SLICE]),
                                           zcc713675e6(zaa4daa1798 * 1.0), zf70a512cde) *
                               z3e204aa540;
        }
    }
    return zaa4daa1798;
}
i32 zc3f89f9109(vcencRateControl_s *zca7520bb04)
{
    if (zca7520bb04->hierarchical_bit_allocation_GOP_size <= (0x1dcd + 14 - 0x1dd3))
        return (0xbb2 + 5946 - 0x22ec);
    i32 zdfb346795b = zca7520bb04->virtualBuffer.bitPerPic;
    i32 z69443ea744 = zca7520bb04->hierarchical_bit_allocation_GOP_size;
    i32 zc7d8469149 = zca7520bb04->zc7d8469149 * zca7520bb04->z8e4b0bbb41 / z69443ea744;
    i32 ze538833e02 = zc7d8469149 - zc7d8469149 / (0xf2a + 701 - 0x11e3);
    i32 z46071b5a95 = zc7d8469149 + zc7d8469149 / (0xfb5 + 2871 - 0x1ae8);
#if (0x78 + 5962 - 0x17c2)
    i32 z5674daa561 = zca7520bb04->z3eab678f73 - zca7520bb04->z3eab678f73 / (0x90d + 436 - 0xab9);
    i32 zbbcebb7c5f = zca7520bb04->z3eab678f73 + zca7520bb04->z3eab678f73 / (0x386 + 6135 - 0x1b75);
    if (zca7520bb04->targetPicSize >= zbbcebb7c5f || zca7520bb04->targetPicSize <= z5674daa561)
        return (0x9d9 + 4838 - 0x1cbe);
#else
    if (zca7520bb04->zc7008a3cc6 >= z46071b5a95 || zca7520bb04->zc7008a3cc6 <= ze538833e02)
        return (0x1363 + 1622 - 0x19b8);
#endif
    return (0x185a + 332 - 0x19a6);
}
#if VBR_RC
u32 z9525c535c6(vcencRateControl_s *zca7520bb04)
{
    u32 sum = (0x1d08 + 316 - 0x1e44);
    for (int i = (0x1316 + 309 - 0x144b); i < (0x9ac + 5112 - 0x1da0); i++) {
        sum += zca7520bb04->pass1GopCost[i] * zca7520bb04->pass1GopFrameNum[i];
    }
    return sum;
}
void zc7b4f40dbc(vcencRateControl_s *zca7520bb04)
{
    if (zca7520bb04->rcMode != VCE_RC_CVBR)
        return;
    if (zca7520bb04->predId != P_SLICE) {
        if (zca7520bb04->predId == I_SLICE)
            zca7520bb04->zc9ed7a8697 = NORMAL_SCENE;
        return;
    }
    zca7520bb04->zc9ed7a8697 = NORMAL_SCENE;
    if (zca7520bb04->pass == (0x199b + 2117 - 0x21de))
        z2089ed76c2(zca7520bb04, zca7520bb04->pass1CurCost);
    if (zca7520bb04->z3a2cd96342[zca7520bb04->predId].z1b1f42bca4 > (0xf64 + 1510 - 0x154a) &&
        zca7520bb04->z3a2cd96342[zca7520bb04->predId].z38e5d4431c > (0x50b + 3316 - 0x11ff)) {
        double z861e0d65a9 = zca7520bb04->z3a2cd96342[zca7520bb04->predId].z861e0d65a9 /
                             zca7520bb04->z3a2cd96342[zca7520bb04->predId].z1b1f42bca4;
        double z255fad4eff = zca7520bb04->z3a2cd96342[zca7520bb04->predId].z255fad4eff /
                             zca7520bb04->z3a2cd96342[zca7520bb04->predId].z38e5d4431c;
#if (0x9d0 + 2114 - 0x1212)
        if (zca7520bb04->predId == P_SLICE) {
            i32 z3e204aa540 =
                zca7520bb04->hierarchical_bit_allocation_GOP_size - (0x752 + 741 - 0xa36);
            if (z3e204aa540 > (0x12d9 + 165 - 0x137d) &&
                zca7520bb04->z3a2cd96342[(0x145f + 730 - 0x1736)].z1b1f42bca4 >
                    (0x1221 + 1369 - 0x177a) &&
                zca7520bb04->z3a2cd96342[(0x1119 + 812 - 0x1442)].z38e5d4431c >
                    (0x9c0 + 3435 - 0x172b)) {
                z861e0d65a9 += zca7520bb04->z3a2cd96342[(0x618 + 3476 - 0x13a9)].z861e0d65a9 /
                               zca7520bb04->z3a2cd96342[(0x257 + 798 - 0x572)].z1b1f42bca4;
                z255fad4eff += zca7520bb04->z3a2cd96342[(0x70b + 3456 - 0x1488)].z255fad4eff /
                               zca7520bb04->z3a2cd96342[(0x7c8 + 7972 - 0x26e9)].z38e5d4431c;
                z3e204aa540--;
            }
            if (z3e204aa540 &&
                zca7520bb04->z3a2cd96342[B_SLICE].z1b1f42bca4 > (0x1754 + 2227 - 0x2007) &&
                zca7520bb04->z3a2cd96342[B_SLICE].z38e5d4431c > (0xdc5 + 100 - 0xe29)) {
                z861e0d65a9 += (zca7520bb04->z3a2cd96342[B_SLICE].z861e0d65a9 /
                                zca7520bb04->z3a2cd96342[B_SLICE].z1b1f42bca4) *
                               z3e204aa540;
                z255fad4eff += (zca7520bb04->z3a2cd96342[B_SLICE].z255fad4eff /
                                zca7520bb04->z3a2cd96342[B_SLICE].z38e5d4431c) *
                               z3e204aa540;
            }
        }
#endif
        double z62af8e6dfb = z255fad4eff * 0.9;
        double z6798585dfb = z255fad4eff * 1.0;
        if (zca7520bb04->z3a2cd96342[zca7520bb04->predId].zca8d2a0001 < z62af8e6dfb &&
            z861e0d65a9 < z62af8e6dfb &&
            zca7520bb04->z0a1ab5b842 >
                zca7520bb04->virtualBuffer.bitPerPic * zca7520bb04->z1c7bacc73e * 0.8)
            zca7520bb04->zc9ed7a8697 = SIMPLE_SCENE;
        else if (zca7520bb04->z3a2cd96342[zca7520bb04->predId].zca8d2a0001 > z6798585dfb)
            zca7520bb04->zc9ed7a8697 = COMPLEX_SCENE;
    }
    return;
}
i32 z4bfe0f8f2a(vcencRateControl_s *zca7520bb04, i32 z2fd9172e8b, i32 z3cf4db5794)
{
    if (zca7520bb04->rcMode != VCE_RC_CVBR)
        return z2fd9172e8b;
    if (zca7520bb04->predId != P_SLICE)
        return z2fd9172e8b;
    if (VBR_RC == (0x554 + 6626 - 0x1f35)) {
        i32 zc0b3525e52 = (0x1bd7 + 1803 - 0x22e2);
        i32 zf58d72cde5 = NORMAL_SCENE;
        i32 id = zca7520bb04->predId;
        char zdfffeaa9ee[(0xf97 + 2219 - 0x183f)][(0x13b + 3957 - 0x1090)] = {
            "\x53\x49\x4d\x50\x4c\x45\x20\x53\x43\x45\x4e\x45",
            "\x4e\x4f\x52\x4d\x41\x4c\x20\x53\x43\x45\x4e\x45",
            "\x43\x4f\x4d\x50\x4c\x45\x58\x20\x53\x43\x45\x4e\x45"};
        if (zca7520bb04->pass == (0x105f + 4356 - 0x2161)) {
            zca7520bb04->zbd6d50ffdd = zca7520bb04->zd99b97e997;
            zca7520bb04->zd99b97e997 = z9525c535c6(zca7520bb04);
            if (zca7520bb04->zbd6d50ffdd == (0x8bf + 6629 - 0x22a4))
                return z2fd9172e8b;
            if (zca7520bb04->hierarchical_bit_allocation_GOP_size == (0x8 + 5792 - 0x16a4)) {
                if (zca7520bb04->zd99b97e997 >= zca7520bb04->zbd6d50ffdd)
                    zf58d72cde5 = COMPLEX_SCENE;
                if (zca7520bb04->zd99b97e997 <
                    (zca7520bb04->zbd6d50ffdd - zca7520bb04->zbd6d50ffdd / (0x3c + 7194 - 0x1c52)))
                    zf58d72cde5 = SIMPLE_SCENE;
                if (zca7520bb04->z45813bc4d2 == (0x1412 + 2792 - 0x1ef2))
                    zf58d72cde5 = COMPLEX_SCENE;
            }
            if (zca7520bb04->hierarchical_bit_allocation_GOP_size == (0x101d + 5245 - 0x2492)) {
                if (zca7520bb04->zd99b97e997 <= zca7520bb04->zbd6d50ffdd)
                    zf58d72cde5 = SIMPLE_SCENE;
                if (zca7520bb04->zd99b97e997 >
                    (zca7520bb04->zbd6d50ffdd + zca7520bb04->zbd6d50ffdd / (0xd77 + 5714 - 0x23c5)))
                    zf58d72cde5 = COMPLEX_SCENE;
                if (zca7520bb04->z45813bc4d2 == (0xb3b + 5729 - 0x2198))
                    zf58d72cde5 = SIMPLE_SCENE;
            }
            zca7520bb04->zc9ed7a8697 = zf58d72cde5;
        } else {
            i32 z2a133108c6 = zca7520bb04->zf066713d8c / (0xa20 + 3408 - 0x1768);
            i32 z0529127272 = zca7520bb04->zc7d8469149 / (0x1bf + 3066 - 0xdb5);
            i32 zb4f8d16f6c = zca7520bb04->zc9ed7a8697;
            zf58d72cde5 = NORMAL_SCENE;
            if (zca7520bb04->zf066713d8c > (0x154 + 3690 - 0xfbe) &&
                zca7520bb04->zc7008a3cc6 < (zca7520bb04->zf066713d8c - z2a133108c6))
                zf58d72cde5 = SIMPLE_SCENE;
            else if (zca7520bb04->zc7008a3cc6 < (zca7520bb04->zc7d8469149 - z0529127272))
                zf58d72cde5 = SIMPLE_SCENE;
            else if ((zca7520bb04->zf066713d8c > (0x3d9 + 1545 - 0x9e2) &&
                      zca7520bb04->zc7008a3cc6 > (zca7520bb04->zf066713d8c + z2a133108c6)) ||
                     zca7520bb04->zc7008a3cc6 > (zca7520bb04->zc7d8469149 + z0529127272))
                zf58d72cde5 = COMPLEX_SCENE;
            zca7520bb04->zc9ed7a8697 = zf58d72cde5;
        }
    }
    if (zca7520bb04->zc9ed7a8697 == SIMPLE_SCENE) {
        z2fd9172e8b = MAX(z2fd9172e8b, (z2fd9172e8b + z3cf4db5794) / (0x994 + 4788 - 0x1c46));
    } else if (zca7520bb04->zc9ed7a8697 == COMPLEX_SCENE &&
               zca7520bb04->z5f310a70ab > (0x648 + 5749 - 0x1cbd)) {
        z2fd9172e8b = MIN(z2fd9172e8b, (z2fd9172e8b + z3cf4db5794) / (0xbe9 + 4512 - 0x1d87));
    }
    return z2fd9172e8b;
}
void z1f46318dc7(vcencRateControl_s *zca7520bb04)
{
    i32 zc0b3525e52 = (0x12c + 7543 - 0x1ea3);
    i32 zf58d72cde5 = zca7520bb04->zc9ed7a8697;
    rcVirtualBuffer_s *z019b8df027 = &zca7520bb04->virtualBuffer;
    if (zca7520bb04->z8e4b0bbb41 < zca7520bb04->hierarchical_bit_allocation_GOP_size)
        return;
    if (zca7520bb04->rcMode != VCE_RC_CVBR)
        return;
    if (zf58d72cde5 == SIMPLE_SCENE) {
        zc0b3525e52 = zca7520bb04->zc7d8469149 - zca7520bb04->zc7008a3cc6;
        if (zc0b3525e52 > (0x136a + 3769 - 0x2223)) {
            z019b8df027->realBitCnt += zc0b3525e52;
            zca7520bb04->z5f310a70ab += zc0b3525e52;
        }
    } else if (zf58d72cde5 == COMPLEX_SCENE) {
        zc0b3525e52 = zca7520bb04->zc7d8469149 - zca7520bb04->zc7008a3cc6;
        zc0b3525e52 = MAX(zc0b3525e52, -zca7520bb04->z5f310a70ab);
        if (zc0b3525e52 < (0x1966 + 374 - 0x1adc)) {
            z019b8df027->realBitCnt += zc0b3525e52;
            zca7520bb04->z5f310a70ab += zc0b3525e52;
        }
    } else {
        zc0b3525e52 = zca7520bb04->zc7d8469149 - zca7520bb04->zc7008a3cc6;
    }
}
#endif
i32 zb93ff510f9(vcencRateControl_s *zca7520bb04)
{
    i32 zaa4daa1798, i, z665d4d61ac;
    i32 id = zca7520bb04->predId;
    i32 zc3e01df886 = (id == B_SLICE) || (id == (0x14cf + 923 - 0x1867));
    i32 zfe56ff2a57 = (id == P_SLICE) && (zca7520bb04->z1c7bacc73e == (0x188a + 1134 - 0x1cf7));
    if (zc3e01df886) {
        zaa4daa1798 = zca7520bb04->z3a2cd96342[P_SLICE].z2fd9172e8b;
        if ((0x15ec + 1046 - 0x1a02) == zc3f89f9109(zca7520bb04))
            goto zf2b0ce4488;
    }
    zaa4daa1798 = z1ef68cc885(zca7520bb04, zca7520bb04->pass1AvgCost, zca7520bb04->pass1FrameNum,
                              zca7520bb04->targetPicSize);
    if ((id == P_SLICE) && (zca7520bb04->pass1EstCostAll == (0x8da + 2989 - 0x1487))) {
        i32 z872cc8d974 = z1ef68cc885(zca7520bb04, zca7520bb04->pass1GopCost,
                                      zca7520bb04->pass1GopFrameNum, zca7520bb04->targetPicSize);
        zaa4daa1798 =
            (zaa4daa1798 >= z872cc8d974)
                ? zaa4daa1798
                : (zaa4daa1798 + z872cc8d974 + (0x6b1 + 4097 - 0x16b1)) >> (0x30 + 3430 - 0xd95);
    }
    zaa4daa1798 <<= QP_FRACTIONAL_BITS;
    if (zc3e01df886 || zfe56ff2a57) {
        zaa4daa1798 = MAX(zaa4daa1798, zca7520bb04->z3a2cd96342[P_SLICE].z2fd9172e8b);
    }
zf2b0ce4488:
#if (0x19d + 1667 - 0x820)
    for (i32 i = (0x132f + 4465 - 0x24a0); i < (0x1e5b + 1408 - 0x23d7); i++) {
        printf(
            "\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x20\x70\x72\x65"
            "\x64\x69\x63\x74\x6f\x72\x20\x25\x64\x20\x63\x6f\x65\x66\x66\x20\x3d\x20\x25\x66\x20"
            "\n",
            i, zca7520bb04->z3a2cd96342[i].z497bd1f85d);
    }
#endif
    return zaa4daa1798;
}
#endif
